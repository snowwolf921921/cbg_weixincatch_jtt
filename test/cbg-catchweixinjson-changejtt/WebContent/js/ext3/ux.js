Ext.tree.ColumnTree=Ext.extend(Ext.tree.TreePanel,{lines:false,borderWidth:Ext.isBorderBox?0:2,cls:"x-column-tree",onRender:function(){Ext.tree.ColumnTree.superclass.onRender.apply(this,arguments);this.headers=this.body.createChild({cls:"x-tree-headers"},this.innerCt.dom);var D=this.columns,E;var B=0;for(var C=0,A=D.length;C<A;C++){E=D[C];B+=E.width;this.headers.createChild({cls:"x-tree-hd "+(E.cls?E.cls+"-hd":""),cn:{cls:"x-tree-hd-text",html:E.header},style:"width:"+(E.width-this.borderWidth)+"px;"})}this.headers.createChild({cls:"x-clear"});this.headers.setWidth(B);this.innerCt.setWidth(B)}});Ext.tree.ColumnNodeUI=Ext.extend(Ext.tree.TreeNodeUI,{focus:Ext.emptyFn,renderElements:function(B,J,F,K){this.indentMarkup=B.parentNode?B.parentNode.ui.getChildIndent():"";var L=B.getOwnerTree();var I=L.columns;var H=L.borderWidth;var G=I[0];var A=['<li class="x-tree-node"><div ext:tree-node-id="',B.id,'" class="x-tree-node-el x-tree-node-leaf ',J.cls,'">','<div class="x-tree-col" style="width:',G.width-H,'px;">','<span class="x-tree-node-indent">',this.indentMarkup,"</span>",'<img src="',this.emptyIcon,'" class="x-tree-ec-icon x-tree-elbow">','<img src="',J.icon||this.emptyIcon,'" class="x-tree-node-icon',(J.icon?" x-tree-node-inline-icon":""),(J.iconCls?" "+J.iconCls:""),'" unselectable="on">','<a hidefocus="on" class="x-tree-node-anchor" href="',J.href?J.href:"#",'" tabIndex="1" ',J.hrefTarget?' target="'+J.hrefTarget+'"':"",">",'<span unselectable="on">',B.text||(G.renderer?G.renderer(J[G.dataIndex],B,J):J[G.dataIndex]),"</span></a>","</div>"];for(var C=1,E=I.length;C<E;C++){G=I[C];A.push('<div class="x-tree-col ',(G.cls?G.cls:""),'" style="width:',G.width-H,'px;">','<div class="x-tree-col-text">',(G.renderer?G.renderer(J[G.dataIndex],B,J):J[G.dataIndex]),"</div>","</div>")}A.push('<div class="x-clear"></div></div>','<ul class="x-tree-node-ct" style="display:none;"></ul>',"</li>");if(K!==true&&B.nextSibling&&B.nextSibling.ui.getEl()){this.wrap=Ext.DomHelper.insertHtml("beforeBegin",B.nextSibling.ui.getEl(),A.join(""))}else{this.wrap=Ext.DomHelper.insertHtml("beforeEnd",F,A.join(""))}this.elNode=this.wrap.childNodes[0];this.ctNode=this.wrap.childNodes[1];var D=this.elNode.firstChild.childNodes;this.indentNode=D[0];this.ecNode=D[1];this.iconNode=D[2];this.anchor=D[3];this.textNode=D[3].firstChild}});
Ext.ns("Ext.ux.form");Ext.ux.form.DateTime=Ext.extend(Ext.form.Field,{defaultAutoCreate:{tag:"input",type:"hidden"},timeWidth:100,dtSeparator:" ",hiddenFormat:"Y-m-d H:i:s",otherToNow:true,timePosition:"right",dateFormat:"m/d/y",timeFormat:"g:i A",timeIncrement:15,timeValue:"",initComponent:function(){Ext.ux.form.DateTime.superclass.initComponent.call(this);var B=Ext.apply({},{id:this.id+"-date",format:this.dateFormat||Ext.form.DateField.prototype.format,width:this.timeWidth,selectOnFocus:this.selectOnFocus,listeners:{blur:{scope:this,fn:this.onBlur},focus:{scope:this,fn:this.onFocus}},value:this.dateValue},this.dateConfig);this.df=new Ext.form.DateField(B);delete (this.dateFormat);var A=Ext.apply({},{id:this.id+"-time",format:this.timeFormat||Ext.form.TimeField.prototype.format,width:this.timeWidth,selectOnFocus:this.selectOnFocus,listeners:{blur:{scope:this,fn:this.onBlur},focus:{scope:this,fn:this.onFocus}},increment:this.timeIncrement,value:this.timeValue},this.timeConfig);this.tf=new Ext.form.TimeField(A);delete (this.timeFormat);this.relayEvents(this.df,["focus","specialkey","invalid","valid"]);this.relayEvents(this.tf,["focus","specialkey","invalid","valid"])},onRender:function(C,A){if(this.isRendered){return }Ext.ux.form.DateTime.superclass.onRender.call(this,C,A);var B;if("below"===this.timePosition||"bellow"===this.timePosition){B=Ext.DomHelper.append(C,{tag:"table",style:"border-collapse:collapse",children:[{tag:"tr",children:[{tag:"td",style:"padding-bottom:1px",cls:"ux-datetime-date"}]},{tag:"tr",children:[{tag:"td",cls:"ux-datetime-time"}]}]},true)}else{B=Ext.DomHelper.append(C,{tag:"table",style:"border-collapse:collapse",children:[{tag:"tr",children:[{tag:"td",style:"padding-right:4px",cls:"ux-datetime-date"},{tag:"td",cls:"ux-datetime-time"}]}]},true)}this.tableEl=B;this.wrap=B.wrap({cls:"x-form-field-wrap"});this.wrap.on("mousedown",this.onMouseDown,this,{delay:10});this.df.render(B.child("td.ux-datetime-date"));this.tf.render(B.child("td.ux-datetime-time"));if(Ext.isIE&&Ext.isStrict){B.select("input").applyStyles({top:0})}this.on("specialkey",this.onSpecialKey,this);this.df.el.swallowEvent(["keydown","keypress"]);this.tf.el.swallowEvent(["keydown","keypress"]);if("side"===this.msgTarget){var D=this.el.findParent(".x-form-element",10,true);this.errorIcon=D.createChild({cls:"x-form-invalid-icon"});this.df.errorIcon=this.errorIcon;this.tf.errorIcon=this.errorIcon}this.el.dom.name=this.hiddenName||this.name||this.id;this.isRendered=true;this.updateHidden()},adjustSize:Ext.BoxComponent.prototype.adjustSize,alignErrorIcon:function(){this.errorIcon.alignTo(this.tableEl,"tl-tr",[2,0])},initDateValue:function(){this.dateValue=this.otherToNow?new Date():new Date(1970,0,1,0,0,0)},clearInvalid:function(){this.df.clearInvalid();this.tf.clearInvalid()},disable:function(){if(this.isRendered){this.df.disabled=this.disabled;this.df.onDisable();this.tf.onDisable()}this.disabled=true;this.df.disabled=true;this.tf.disabled=true;this.fireEvent("disable",this);return this},enable:function(){if(this.rendered){this.df.onEnable();this.tf.onEnable()}this.disabled=false;this.df.disabled=false;this.tf.disabled=false;this.fireEvent("enable",this);return this},focus:function(){this.df.focus()},getPositionEl:function(){return this.wrap},getResizeEl:function(){return this.wrap},getValue:function(){return this.dateValue?new Date(this.dateValue):""},isValid:function(){return this.df.isValid()&&this.tf.isValid()},isVisible:function(){return this.df.rendered&&this.df.getActionEl().isVisible()},onBlur:function(A){if(this.wrapClick){A.focus();this.wrapClick=false}if(A===this.df){this.updateDate()}else{this.updateTime()}this.updateHidden();(function(){if(!this.df.hasFocus&&!this.tf.hasFocus){var B=this.getValue();if(String(B)!==String(this.startValue)){this.fireEvent("change",this,B,this.startValue)}this.hasFocus=false;this.fireEvent("blur",this)}}).defer(100,this)},onFocus:function(){if(!this.hasFocus){this.hasFocus=true;this.startValue=this.getValue();this.fireEvent("focus",this)}},onMouseDown:function(A){if(!this.disabled){this.wrapClick="td"===A.target.nodeName.toLowerCase()}},onSpecialKey:function(B,C){var A=C.getKey();if(A===C.TAB){if(B===this.df&&!C.shiftKey){C.stopEvent();this.tf.focus()}if(B===this.tf&&C.shiftKey){C.stopEvent();this.df.focus()}}if(A===C.ENTER){this.updateValue()}},setDate:function(A){this.df.setValue(A)},setTime:function(A){this.tf.setValue(A)},setSize:function(A,B){if(!A){return }if("below"===this.timePosition){this.df.setSize(A,B);this.tf.setSize(A,B);if(Ext.isIE){this.df.el.up("td").setWidth(A);this.tf.el.up("td").setWidth(A)}}else{this.df.setSize(A-this.timeWidth-4,B);this.tf.setSize(this.timeWidth,B);if(Ext.isIE){this.df.el.up("td").setWidth(A-this.timeWidth-4);this.tf.el.up("td").setWidth(this.timeWidth)}}},setValue:function(C){if(!C&&true===this.emptyToNow){this.setValue(new Date());return }else{if(!C){this.setDate("");this.setTime("");this.updateValue();return }}if("number"===typeof C){C=new Date(C)}C=C?C:new Date(1970,0,1,0,0,0);var A,B;if(C instanceof Date){this.setDate(C);this.setTime(C);this.dateValue=new Date(C)}else{A=C.split(this.dtSeparator);this.setDate(A[0]);if(A[1]){this.setTime(A[1])}}this.updateValue()},setVisible:function(A){if(A){this.df.show();this.tf.show()}else{this.df.hide();this.tf.hide()}return this},show:function(){return this.setVisible(true)},hide:function(){return this.setVisible(false)},updateDate:function(){var A=this.df.getValue();if(A){if(!(this.dateValue instanceof Date)){this.initDateValue();if(!this.tf.getValue()){this.setTime(this.dateValue)}}this.dateValue.setMonth(0);this.dateValue.setFullYear(A.getFullYear());this.dateValue.setMonth(A.getMonth());this.dateValue.setDate(A.getDate())}else{this.dateValue="";this.setTime("")}},updateTime:function(){var A=this.tf.getValue();if(A&&!(A instanceof Date)){A=Date.parseDate(A,this.tf.format)}if(A&&!this.df.getValue()){this.initDateValue();this.setDate(this.dateValue)}if(this.dateValue instanceof Date){if(A){this.dateValue.setHours(A.getHours());this.dateValue.setMinutes(A.getMinutes());this.dateValue.setSeconds(A.getSeconds())}else{this.dateValue.setHours(0);this.dateValue.setMinutes(0);this.dateValue.setSeconds(0)}}},updateHidden:function(){if(this.isRendered){var A=this.dateValue instanceof Date?this.dateValue.format(this.hiddenFormat):"";this.el.dom.value=A}},updateValue:function(){this.updateDate();this.updateTime();this.updateHidden();return },validate:function(){return this.df.validate()&&this.tf.validate()},renderer:function(C){var B=C.editor.dateFormat||Ext.ux.form.DateTime.prototype.dateFormat;B+=" "+(C.editor.timeFormat||Ext.ux.form.DateTime.prototype.timeFormat);var A=function(E){var D=Ext.util.Format.date(E,B);return D};return A}});Ext.reg("xdatetime",Ext.ux.form.DateTime);
Ext.form.FileUploadField=Ext.extend(Ext.form.TextField,{buttonText:"Browse...",buttonOnly:false,buttonOffset:3,readOnly:true,autoSize:Ext.emptyFn,initComponent:function(){Ext.form.FileUploadField.superclass.initComponent.call(this);this.addEvents("fileselected")},onRender:function(C,A){Ext.form.FileUploadField.superclass.onRender.call(this,C,A);this.wrap=this.el.wrap({cls:"x-form-field-wrap x-form-file-wrap"});this.el.addClass("x-form-file-text");this.el.dom.removeAttribute("name");this.fileInput=this.wrap.createChild({id:this.getFileInputId(),name:this.name||this.getId(),cls:"x-form-file",tag:"input",type:"file",size:1});var B=Ext.applyIf(this.buttonCfg||{},{text:this.buttonText});this.button=new Ext.Button(Ext.apply(B,{renderTo:this.wrap,cls:"x-form-file-btn"+(B.iconCls?" x-btn-icon":"")}));if(this.buttonOnly){this.el.hide();this.wrap.setWidth(this.button.getEl().getWidth())}this.fileInput.on("change",function(){var D=this.fileInput.dom.value;this.setValue(D);this.fireEvent("fileselected",this,D)},this)},getFileInputId:function(){return this.id+"-file"},onResize:function(A,B){Ext.form.FileUploadField.superclass.onResize.call(this,A,B);this.wrap.setWidth(A);if(!this.buttonOnly){var A=this.wrap.getWidth()-this.button.getEl().getWidth()-this.buttonOffset;this.el.setWidth(A)}},preFocus:Ext.emptyFn,getResizeEl:function(){return this.wrap},getPositionEl:function(){return this.wrap},alignErrorIcon:function(){this.errorIcon.alignTo(this.wrap,"tl-tr",[2,0])}});Ext.reg("fileuploadfield",Ext.form.FileUploadField);
Ext.namespace("Ext.ux.netbox");Ext.ux.netbox.InputTextMask=function(A,D){if(D===undefined){this.clearWhenInvalid=true}else{this.clearWhenInvalid=D}this.rawMask=A;this.viewMask="";this.maskArray=new Array();var C=0;var E="";for(var B=0;B<A.length;B++){if(E){if(E=="X"){E=""}if(A.charAt(B)=="X"){this.maskArray[C]=E;C++;E=""}else{E+=A.charAt(B)}}else{if(A.charAt(B)=="X"){E+="X";this.viewMask+="_"}else{if(A.charAt(B)=="9"||A.charAt(B)=="L"||A.charAt(B)=="l"||A.charAt(B)=="A"){this.viewMask+="_";this.maskArray[C]=A.charAt(B);C++}else{this.viewMask+=A.charAt(B);this.maskArray[C]=RegExp.escape(A.charAt(B));C++}}}}this.specialChars=this.viewMask.replace(/(L|l|9|A|_|X)/g,"")};Ext.ux.netbox.InputTextMask.prototype={init:function(A){this.field=A;if(A.rendered){this.assignEl()}else{A.on("render",this.assignEl,this)}A.on("blur",this.removeValueWhenInvalid,this);A.on("focus",this.processMaskFocus,this)},assignEl:function(){this.inputTextElement=this.field.getEl().dom;this.field.getEl().on("keypress",this.processKeyPress,this);this.field.getEl().on("keydown",this.processKeyDown,this);if(Ext.isSafari||Ext.isIE){this.field.getEl().on("paste",this.startTask,this);this.field.getEl().on("cut",this.startTask,this)}if(Ext.isGecko||Ext.isOpera){this.field.getEl().on("mousedown",this.setPreviousValue,this)}if(Ext.isGecko){this.field.getEl().on("input",this.onInput,this)}if(Ext.isOpera){this.field.getEl().on("input",this.onInputOpera,this)}},onInput:function(){this.startTask(false)},onInputOpera:function(){if(!this.prevValueOpera){this.startTask(false)}else{this.manageBackspaceAndDeleteOpera()}},manageBackspaceAndDeleteOpera:function(){this.inputTextElement.value=this.prevValueOpera.cursorPos.previousValue;this.manageTheText(this.prevValueOpera.keycode,this.prevValueOpera.cursorPos);this.prevValueOpera=null},setPreviousValue:function(A){this.oldCursorPos=this.getCursorPosition()},getValidatedKey:function(B,A){var C=this.maskArray[A.start];if(C=="9"){return B.pressedKey.match(/[0-9]/)}else{if(C=="L"){return(B.pressedKey.match(/[A-Za-z]/))?B.pressedKey.toUpperCase():null}else{if(C=="l"){return(B.pressedKey.match(/[A-Za-z]/))?B.pressedKey.toLowerCase():null}else{if(C=="A"){return B.pressedKey.match(/[A-Za-z0-9]/)}else{if(C){return(B.pressedKey.match(new RegExp(C)))}}}}}return(null)},removeValueWhenInvalid:function(){if(this.clearWhenInvalid&&this.inputTextElement.value.indexOf("_")>-1){this.inputTextElement.value=""}},managePaste:function(){if(this.oldCursorPos==null){return }var C=this.inputTextElement.value.substring(this.oldCursorPos.start,this.inputTextElement.value.length-(this.oldCursorPos.previousValue.length-this.oldCursorPos.end));if(this.oldCursorPos.start<this.oldCursorPos.end){this.oldCursorPos.previousValue=this.oldCursorPos.previousValue.substring(0,this.oldCursorPos.start)+this.viewMask.substring(this.oldCursorPos.start,this.oldCursorPos.end)+this.oldCursorPos.previousValue.substring(this.oldCursorPos.end,this.oldCursorPos.previousValue.length);C=C.substr(0,this.oldCursorPos.end-this.oldCursorPos.start)}this.inputTextElement.value=this.oldCursorPos.previousValue;keycode={unicode:"",isShiftPressed:false,isTab:false,isBackspace:false,isLeftOrRightArrow:false,isDelete:false,pressedKey:""};var B=false;for(var A=0;A<C.length;A++){keycode.pressedKey=C.substr(A,1);keycode.unicode=C.charCodeAt(A);this.oldCursorPos=this.skipMaskCharacters(keycode,this.oldCursorPos);if(this.oldCursorPos===false){break}if(this.injectValue(keycode,this.oldCursorPos)){B=true;this.moveCursorToPosition(keycode,this.oldCursorPos);this.oldCursorPos.previousValue=this.inputTextElement.value;this.oldCursorPos.start=this.oldCursorPos.start+1}}if(!B&&this.oldCursorPos!==false){this.moveCursorToPosition(null,this.oldCursorPos)}this.oldCursorPos=null},processKeyDown:function(A){this.processMaskFormatting(A,"keydown")},processKeyPress:function(A){this.processMaskFormatting(A,"keypress")},startTask:function(A){if(this.task==undefined){this.task=new Ext.util.DelayedTask(this.managePaste,this)}if(A!==false){this.oldCursorPos=this.getCursorPosition()}this.task.delay(0)},skipMaskCharacters:function(A,B){if(B.start!=B.end&&(A.isDelete||A.isBackspace)){return(B)}while(this.specialChars.match(RegExp.escape(this.viewMask.charAt(((A.isBackspace)?B.start-1:B.start))))){if(A.isBackspace){B.dec()}else{B.inc()}if(B.start>=B.previousValue.length||B.start<0){return false}}return(B)},isManagedByKeyDown:function(A){if(A.isDelete||A.isBackspace){return(true)}return(false)},processMaskFormatting:function(C,B){this.oldCursorPos=null;var D=this.getCursorPosition();var A=this.getKeyCode(C,B);if(A.unicode==0){return }if((A.unicode==67||A.unicode==99)&&C.ctrlKey){return }if((A.unicode==88||A.unicode==120)&&C.ctrlKey){this.startTask();return }if((A.unicode==86||A.unicode==118)&&C.ctrlKey){this.startTask();return }if((A.isBackspace||A.isDelete)&&Ext.isOpera){this.prevValueOpera={cursorPos:D,keycode:A};return }if(B=="keydown"&&!this.isManagedByKeyDown(A)){return true}if(B=="keypress"&&this.isManagedByKeyDown(A)){return true}if(this.handleEventBubble(C,A,B)){return true}return(this.manageTheText(A,D))},manageTheText:function(A,B){if(this.inputTextElement.value.length===0){this.inputTextElement.value=this.viewMask}B=this.skipMaskCharacters(A,B);if(B===false){return false}if(this.injectValue(A,B)){this.moveCursorToPosition(A,B)}return(false)},processMaskFocus:function(){if(this.inputTextElement.value.length==0){var A=this.getCursorPosition();this.inputTextElement.value=this.viewMask;this.moveCursorToPosition(null,A)}},isManagedByBrowser:function(C,A,B){if(((B=="keypress"&&C.charCode===0)||B=="keydown")&&(A.unicode==Ext.EventObject.TAB||A.unicode==Ext.EventObject.RETURN||A.unicode==Ext.EventObject.ENTER||A.unicode==Ext.EventObject.SHIFT||A.unicode==Ext.EventObject.CONTROL||A.unicode==Ext.EventObject.ESC||A.unicode==Ext.EventObject.PAGEUP||A.unicode==Ext.EventObject.PAGEDOWN||A.unicode==Ext.EventObject.END||A.unicode==Ext.EventObject.HOME||A.unicode==Ext.EventObject.LEFT||A.unicode==Ext.EventObject.UP||A.unicode==Ext.EventObject.RIGHT||A.unicode==Ext.EventObject.DOWN)){return(true)}return(false)},handleEventBubble:function(C,A,B){try{if(A&&this.isManagedByBrowser(C,A,B)){return true}C.stopEvent();return false}catch(D){alert(D.message)}},getCursorPosition:function(){var A,C,B;if(this.inputTextElement.createTextRange){B=document.selection.createRange().duplicate();B.moveEnd("character",this.inputTextElement.value.length);if(B.text===""){A=this.inputTextElement.value.length}else{A=this.inputTextElement.value.lastIndexOf(B.text)}B=document.selection.createRange().duplicate();B.moveStart("character",-this.inputTextElement.value.length);C=B.text.length}else{A=this.inputTextElement.selectionStart;C=this.inputTextElement.selectionEnd}return this.CursorPosition(A,C,B,this.inputTextElement.value)},moveCursorToPosition:function(B,A){var C=(!B||(B&&B.isBackspace))?A.start:A.start+1;if(this.inputTextElement.createTextRange){A.range.move("character",C);A.range.select()}else{this.inputTextElement.selectionStart=C;this.inputTextElement.selectionEnd=C}},injectValue:function(B,A){if(!B.isDelete&&B.unicode==A.previousValue.charCodeAt(A.start)){return true}var C;if(!B.isDelete&&!B.isBackspace){C=this.getValidatedKey(B,A)}else{if(A.start==A.end){C="_";if(B.isBackspace){A.dec()}}else{C=this.viewMask.substring(A.start,A.end)}}if(C){this.inputTextElement.value=A.previousValue.substring(0,A.start)+C+A.previousValue.substring(A.start+C.length,A.previousValue.length);return true}return false},getKeyCode:function(B,C){var A={};A.unicode=B.getKey();A.isShiftPressed=B.shiftKey;A.isDelete=((B.getKey()==Ext.EventObject.DELETE&&C=="keydown")||(C=="keypress"&&B.charCode===0&&B.keyCode==Ext.EventObject.DELETE))?true:false;A.isTab=(B.getKey()==Ext.EventObject.TAB)?true:false;A.isBackspace=(B.getKey()==Ext.EventObject.BACKSPACE)?true:false;A.isLeftOrRightArrow=(B.getKey()==Ext.EventObject.LEFT||B.getKey()==Ext.EventObject.RIGHT)?true:false;A.pressedKey=String.fromCharCode(A.unicode);return(A)},CursorPosition:function(E,C,D,B){var A={};A.start=isNaN(E)?0:E;A.end=isNaN(C)?0:C;A.range=D;A.previousValue=B;A.inc=function(){A.start++;A.end++};A.dec=function(){A.start--;A.end--};return(A)}};Ext.applyIf(RegExp,{escape:function(A){return new String(A).replace(/([.*+?^=!:${}()|[\]\/\\])/g,"\\$1")}});Ext.ux.InputTextMask=Ext.ux.netbox.InputTextMask;
Ext.ns("Ext.ux.form");Ext.ux.form.LovCombo=Ext.extend(Ext.form.ComboBox,{checkField:"checked",separator:",",initComponent:function(){if(!this.tpl){this.tpl='<tpl for="."><div class="x-combo-list-item"><img src="'+Ext.BLANK_IMAGE_URL+'" class="ux-lovcombo-icon ux-lovcombo-icon-{[values.'+this.checkField+'?"checked":"unchecked"]}"><div class="ux-lovcombo-item-text">{'+this.displayField+"}</div></div></tpl>"}Ext.ux.form.LovCombo.superclass.initComponent.apply(this,arguments);this.on({scope:this,beforequery:this.onBeforeQuery,blur:this.onRealBlur});this.onLoad=this.onLoad.createSequence(function(){if(this.el){var A=this.el.dom.value;this.el.dom.value="";this.el.dom.value=A}})},initEvents:function(){Ext.ux.form.LovCombo.superclass.initEvents.apply(this,arguments);this.keyNav.tab=false},clearValue:function(){this.value="";this.setRawValue(this.value);this.store.clearFilter();this.store.each(function(A){A.set(this.checkField,false)},this);if(this.hiddenField){this.hiddenField.value=""}},getCheckedDisplay:function(){var A=new RegExp(this.separator,"g");return this.getCheckedValue(this.displayField).replace(A,this.separator+" ")},getCheckedValue:function(B){B=B||this.valueField;var C=[];var A=this.store.snapshot||this.store.data;A.each(function(D){if(D.get(this.checkField)){C.push(D.get(B))}},this);return C.join(this.separator)},onBeforeQuery:function(A){A.query=A.query.replace(new RegExp(this.getCheckedDisplay()+"[ "+this.separator+"]*"),"")},onRealBlur:function(){this.list.hide();var A=this.getRawValue();var B=[];this.store.clearFilter();this.store.each(function(D){var C=new RegExp(D.get(this.displayField));if(A.match(C)){B.push(D.get(this.valueField))}},this);this.setValue(B.join(this.separator))},onSelect:function(A,B){if(this.fireEvent("beforeselect",this,A,B)!==false){A.set(this.checkField,!A.get(this.checkField));this.doQuery(this.allQuery);this.setValue(this.getCheckedValue());this.fireEvent("select",this,A,B)}},setValue:function(A){if(A){A=""+A;if(this.valueField){this.store.clearFilter();this.store.each(function(C){var B=!(!A.match(C.get(this.valueField)));C.set(this.checkField,B)},this);this.value=this.getCheckedValue();this.setRawValue(this.getCheckedDisplay());if(this.hiddenField){this.hiddenField.value=this.value}}else{this.value=A;this.setRawValue(A);if(this.hiddenField){this.hiddenField.value=A}}}else{this.clearValue()}},getValue:function(){if(this.valueField){return typeof this.value!="undefined"?this.value:""}else{return Ext.form.ComboBox.superclass.getValue.call(this)}}});Ext.reg("lovcombo",Ext.ux.form.LovCombo);
Ext.namespace("Ext.ux");Ext.namespace("Ext.ux.form");Ext.ux.form.MailTreeMultiSelect=Ext.extend(Ext.form.TriggerField,{treeWin:null,treeUrl:"\u672a\u8bbe\u7f6etreeUrl",treeRootId:4,treeRootText:"\u6839\u8282\u70b9",treeRootVisible:true,treeWinWidth:650,treeWinHeight:400,treeWinTitle:"\u591a\u9009\u5bf9\u8bdd\u6846",triggerClass:"x-form-search-trigger",showAllUserBtn:true,defaultSelected:[],nodeValueTypeSelect:undefined,nowSelectNode:null,init:function(){var E=Ext.data.Record.create([{name:"itemId",type:"string"},{name:"itemText",type:"string"}]);var C=new Ext.tree.TreePanel({title:"\u53ef\u9009\u9879",rootVisible:this.treeRootVisible,loader:new Ext.tree.TreeLoader({dataUrl:""}),autoScroll:true,enableDrag:true,ddGroup:"MultiSelect",region:"west",width:250,split:true,tools:[{id:"refresh",on:{click:function(){C.body.mask("\u6b63\u5728\u52a0\u8f7d\u6570\u636e...","x-mask-loading");C.root.reload();C.root.collapse(true,false);setTimeout(function(){C.body.unmask();C.root.expand(false,false)},1000)}}}],root:new Ext.tree.AsyncTreeNode({text:this.treeRootText,id:this.treeRootId,leaf:false,expanded:true,singleClickExpand:true}),listeners:{beforeload:function(I){C.loader.baseParams.category=I.attributes.category;C.loader.dataUrl=this.treeUrl+I.id},click:function(J){if(this.nodeValueTypeSelect==0){if(D.find("itemId",J.id)==-1){var I=new E({itemId:J.id,itemText:J.text});D.add(I)}}else{if(this.nodeValueTypeSelect==1){nowSelectNode=J;if(J.isLeaf()&&J.attributes.nodeValueType==1){if(D.find("itemId",J.id)==-1){var I=new E({itemId:J.id,itemText:J.text});D.add(I)}}}}},scope:this}});var B;var D=new Ext.data.SimpleStore({data:this.defaultSelected,fields:[{name:"itemId"},{name:"itemText"}],listeners:{add:function(){B.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")},remove:function(){B.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")},load:function(){if(B){B.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")}},clear:function(){B.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")}}});var A=new Ext.Action({text:"\u6e05\u7a7a\u5168\u90e8",handler:function(){D.removeAll()}});var H=new Ext.Action({text:"\u9009\u62e9\u5f53\u524d\u90e8\u95e8\u4e0b\u6240\u6709\u4eba\u5458",hidden:!this.showAllUserBtn,handler:function(){var I=new Array();var J=function(N){var M=N.childNodes;for(var L=0;L<M.length;L++){if(M[L].isLeaf()&&D.find("itemId",M[L].id)==-1&&M[L].attributes.nodeValueType==1){var K=new E({itemId:M[L].id,itemText:M[L].text});D.add(K)}else{if(M[L].hasChildNodes()){M[L].expand();I.push(M[L])}}}if(I.length>0){J(I.shift())}};if((typeof (nowSelectNode)=="undefined")||nowSelectNode==null){Ext.MessageBox.show({title:"\u63d0\u793a",msg:"\u8bf7\u9009\u62e9\u4e00\u4e2a\u8282\u70b9\uff01",buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.ERROR})}else{if(nowSelectNode.isLeaf()){}else{F.body.mask("\u6b63\u5728\u52a0\u8f7d\u6570\u636e...","x-mask-loading");setTimeout(function(){F.body.unmask();J(nowSelectNode)},1000);J(nowSelectNode)}}}});var G=this.nodeValueTypeSelect;var F=new Ext.grid.GridPanel({width:370,hideHeaders:true,store:D,enableHdMenu:false,enableDragDrop:true,ddGroup:"MultiSelect",tbar:[A,H],columns:[new Ext.grid.RowNumberer(),{header:"\u6807\u8bc6",width:60,sortable:false,dataIndex:"itemId",hidden:true},{id:"itemText",header:"\u540d\u79f0",width:160,sortable:false,dataIndex:"itemText"}],stripeRows:true,autoExpandColumn:"itemText",region:"center",sm:new Ext.grid.RowSelectionModel({listeners:{rowselect:function(K,J,I){if(J<D.getCount()-1){D.remove(I);F.getView().refresh()}else{D.remove.defer(10,D,[I])}}}}),listeners:{render:function(J){if(!B){var K=F.getTopToolbar();B=Ext.fly(K.el.dom).createChild({cls:"x-paging-info"});B.update("\u5171\u9009\u4e2d"+D.getCount()+"\u9879")}var I=new Ext.dd.DropTarget(F.getEl(),{ddGroup:"MultiSelect",copy:false,notifyDrop:function(M,R,P){var Q=Ext.lib.Event.getTarget(R);var L="";var N=F.getView().findRowIndex(Q);if(P.node!=null){if(G==0){if(D.find("itemId",P.node.id)==-1){var O=new E({itemId:P.node.id,itemText:P.node.text});if(N===false){D.add(O)}else{D.insert(N,O)}F.getView().refresh();return true}}else{if(G==1){if(P.node.isLeaf()){if(D.find("itemId",P.node.id)==-1&&P.node.attributes.nodeValueType==1){var O=new E({itemId:P.node.id,itemText:P.node.text});if(N===false){D.add(O)}else{D.insert(N,O)}F.getView().refresh();return true}}else{P.node.eachChild(function(T){if(T.isLeaf()&&D.find("itemId",T.id)==-1&&T.attributes.nodeValueType==1){var S=new E({itemId:T.id,itemText:T.text});if(N===false){D.add(S)}else{D.insert(N++,S)}}});F.getView().refresh();return true}}}}return false}})}}});this.treeWin=new Ext.Window({title:this.treeWinTitle,layout:"border",store:D,width:this.treeWinWidth,height:this.treeWinHeight,items:[C,F],modal:true,closeAction:"hide",resizable:false,buttonAlign:"center",buttons:[{text:"\u786e\u5b9a",listeners:{click:function(){var I=[],J=[];D.each(function(K){I.push(K.get("itemId"));J.push(K.get("itemText"))});this.setValue(J.join(","));if(this.hiddenName){this.hiddenField.value=I.join(",")}this.treeWin.hide()},scope:this}},{text:"\u53d6\u6d88",listeners:{click:function(){this.treeWin.hide()},scope:this}}]})},onTriggerClick:function(){if(this.disabled){return }if(!this.treeWin){this.init()}this.treeWin.show(this.trigger)},onRender:function(C,A){if(this.defaultSelected.length>0){var D="",F="",E="";for(var B=0;B<this.defaultSelected.length;B++){F=F+D+this.defaultSelected[B][0];E=E+D+this.defaultSelected[B][1];D=","}this.value=E;this.hiddenValue=F}Ext.ux.form.TreeMultiSelect.superclass.onRender.call(this,C,A);if(this.hiddenName){this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId||this.hiddenName)},"before",true);this.hiddenField.value=this.hiddenValue!==undefined?this.hiddenValue:this.value!==undefined?this.value:"";this.el.dom.removeAttribute("name")}},onDestroy:function(){if(this.treeWin){this.treeWin.destroy();this.treeWin=null}Ext.ux.form.TreeMultiSelect.superclass.onDestroy.call(this)},getValue:function(){if(this.hiddenField){return this.hiddenField.value}else{return Ext.form.ComboBox.superclass.getValue.call(this)}},getVisiableValue:function(){return Ext.form.ComboBox.superclass.getValue.call(this)},setSelectedValue:function(B){this.defaultSelected=B;if(this.defaultSelected.length>0){var C="",E="",D="";for(var A=0;A<this.defaultSelected.length;A++){E=E+C+this.defaultSelected[A][0];D=D+C+this.defaultSelected[A][1];C=","}this.setRawValue(D);this.hiddenValue=E;if(this.hiddenField){this.hiddenField.value=E}if(this.treeWin){if(this.defaultSelected.length>0){this.treeWin.store.loadData(this.defaultSelected)}else{this.treeWin.store.removeAll()}}}},clearValue:function(){if(this.hiddenField){this.hiddenField.value="";this.hiddenValue=""}this.setRawValue("");this.value=""},reset:function(){if(this.defaultSelected.length>0){var B="",D="",C="";for(var A=0;A<this.defaultSelected.length;A++){D=D+B+this.defaultSelected[A][0];C=C+B+this.defaultSelected[A][1];B=","}this.setRawValue(C);this.hiddenValue=D;if(this.hiddenField){this.hiddenField.value=D}if(this.treeWin){if(this.defaultSelected.length>0){this.treeWin.store.loadData(this.defaultSelected)}else{this.treeWin.store.removeAll()}}}}});Ext.reg("mailtreemultiselect",Ext.ux.form.MailTreeMultiSelect);
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
if(!Array.prototype.map){Array.prototype.map=function(B){var A=this.length;if(typeof B!="function"){throw new TypeError()}var E=new Array(A);var D=arguments[1];for(var C=0;C<A;C++){if(C in this){E[C]=B.call(D,this[C],C,this)}}return E}}Ext.ns("Ext.ux.data");Ext.ux.data.PagingMemoryProxy=Ext.extend(Ext.data.MemoryProxy,{constructor:function(A){Ext.ux.data.PagingMemoryProxy.superclass.constructor.call(this);this.data=A},doRequest:function(C,D,B,E,H,I,J){B=B||{};this.data=this.data||B.data;var K;try{K=E.readRecords(this.data)}catch(F){this.fireEvent("loadexception",this,J,null,F);H.call(I,null,J,false);return }if(B.filter!==undefined){K.records=K.records.filter(function(M){if(typeof (M)=="object"){var L=B.filterCol||0;return String(M.data[L]).match(B.filter)?true:false}else{return String(M).match(B.filter)?true:false}});K.totalRecords=K.records.length}if(B.sort!==undefined){var A=String(B.dir).toUpperCase()=="DESC"?-1:1;var G=function(M,L){return M<L};K.records.sort(function(M,L){var N=0;if(typeof (M)=="object"){N=G(M.data[B.sort],L.data[B.sort])*A}else{N=G(M,L)*A}if(N==0){N=(M.index<L.index?-1:1)}return N})}if(B.start!==undefined&&B.limit!==undefined){K.records=K.records.slice(B.start,B.start+B.limit)}H.call(I,K,J,true)}});Ext.data.PagingMemoryProxy=Ext.ux.data.PagingMemoryProxy;
/*
 * Ext JS Library 3.0.0
 * Copyright(c) 2006-2009 Ext JS, LLC
 * licensing@extjs.com
 * http://www.extjs.com/license
 */
Ext.ns("Ext.ux.grid");Ext.ux.grid.RowExpander=Ext.extend(Ext.util.Observable,{expandOnEnter:true,expandOnDblClick:true,header:"",width:20,sortable:false,fixed:true,menuDisabled:true,dataIndex:"",id:"expander",lazyRender:true,enableCaching:true,constructor:function(A){Ext.apply(this,A);this.addEvents({beforeexpand:true,expand:true,beforecollapse:true,collapse:true});Ext.ux.grid.RowExpander.superclass.constructor.call(this);if(this.tpl){if(typeof this.tpl=="string"){this.tpl=new Ext.Template(this.tpl)}this.tpl.compile()}this.state={};this.bodyContent={}},getRowClass:function(A,E,D,C){D.cols=D.cols-1;var B=this.bodyContent[A.id];if(!B&&!this.lazyRender){B=this.getBodyContent(A,E)}if(B){D.body=B}return this.state[A.id]?"x-grid3-row-expanded":"x-grid3-row-collapsed"},init:function(B){this.grid=B;var A=B.getView();A.getRowClass=this.getRowClass.createDelegate(this);A.enableRowBody=true;B.on("render",this.onRender,this);B.on("destroy",this.onDestroy,this)},onRender:function(){var A=this.grid;var B=A.getView().mainBody;B.on("mousedown",this.onMouseDown,this,{delegate:".x-grid3-row-expander"});if(this.expandOnEnter){this.keyNav=new Ext.KeyNav(this.grid.getGridEl(),{enter:this.onEnter,scope:this})}if(this.expandOnDblClick){A.on("rowdblclick",this.onRowDblClick,this)}},onDestroy:function(){this.keyNav.disable();delete this.keyNav;var A=this.grid.getView().mainBody;A.un("mousedown",this.onMouseDown,this)},onRowDblClick:function(A,B,C){this.toggleRow(B)},onEnter:function(F){var E=this.grid;var G=E.getSelectionModel();var B=G.getSelections();for(var C=0,A=B.length;C<A;C++){var D=E.getStore().indexOf(B[C]);this.toggleRow(D)}},getBodyContent:function(A,B){if(!this.enableCaching){return this.tpl.apply(A.data)}var C=this.bodyContent[A.id];if(!C){C=this.tpl.apply(A.data);this.bodyContent[A.id]=C}return C},onMouseDown:function(B,A){B.stopEvent();var C=B.getTarget(".x-grid3-row");this.toggleRow(C)},renderer:function(B,C,A){C.cellAttr='rowspan="2"';return'<div class="x-grid3-row-expander">&#160;</div>'},beforeExpand:function(B,A,C){if(this.fireEvent("beforeexpand",this,B,A,C)!==false){if(this.tpl&&this.lazyRender){A.innerHTML=this.getBodyContent(B,C)}return true}else{return false}},toggleRow:function(A){if(typeof A=="number"){A=this.grid.view.getRow(A)}this[Ext.fly(A).hasClass("x-grid3-row-collapsed")?"expandRow":"collapseRow"](A)},expandRow:function(C){if(typeof C=="number"){C=this.grid.view.getRow(C)}var B=this.grid.store.getAt(C.rowIndex);var A=Ext.DomQuery.selectNode("tr:nth(2) div.x-grid3-row-body",C);if(this.beforeExpand(B,A,C.rowIndex)){this.state[B.id]=true;Ext.fly(C).replaceClass("x-grid3-row-collapsed","x-grid3-row-expanded");this.fireEvent("expand",this,B,A,C.rowIndex)}},collapseRow:function(C){if(typeof C=="number"){C=this.grid.view.getRow(C)}var B=this.grid.store.getAt(C.rowIndex);var A=Ext.fly(C).child("tr:nth(1) div.x-grid3-row-body",true);if(this.fireEvent("beforecollapse",this,B,A,C.rowIndex)!==false){this.state[B.id]=false;Ext.fly(C).replaceClass("x-grid3-row-expanded","x-grid3-row-collapsed");this.fireEvent("collapse",this,B,A,C.rowIndex)}}});Ext.preg("rowexpander",Ext.ux.grid.RowExpander);Ext.grid.RowExpander=Ext.ux.grid.RowExpander;
Ext.namespace("Ext.ux");Ext.namespace("Ext.ux.grid");Ext.ux.grid.RowSelectionModel=function(A){Ext.apply(this,A);this.selections=new Ext.util.MixedCollection(false,function(B){return B.id});this.last=false;this.lastActive=false;this.addEvents({selectionchange:true,beforerowselect:true,rowselect:true,rowdeselect:true,rowclick:true});Ext.ux.grid.RowSelectionModel.superclass.constructor.call(this)};Ext.extend(Ext.ux.grid.RowSelectionModel,Ext.grid.AbstractSelectionModel,{singleSelect:false,initEvents:function(){if(!this.grid.enableDragDrop&&!this.grid.enableDrag){this.grid.on("rowmousedown",this.handleMouseDown,this)}else{this.grid.on("rowclick",function(B,D,C){if(C.button===0&&!C.shiftKey&&!C.ctrlKey){this.selectRow(D,false);B.view.focusRow(D)}},this)}this.rowNav=new Ext.KeyNav(this.grid.getGridEl(),{up:function(C){if(!C.shiftKey){this.selectPrevious(C.shiftKey)}else{if(this.last!==false&&this.lastActive!==false){var B=this.last;this.selectRange(this.last,this.lastActive-1);this.grid.getView().focusRow(this.lastActive);if(B!==false){this.last=B}}else{this.selectFirstRow()}}},down:function(C){if(!C.shiftKey){this.selectNext(C.shiftKey)}else{if(this.last!==false&&this.lastActive!==false){var B=this.last;this.selectRange(this.last,this.lastActive+1);this.grid.getView().focusRow(this.lastActive);if(B!==false){this.last=B}}else{this.selectFirstRow()}}},scope:this});var A=this.grid.view;A.on("refresh",this.onRefresh,this);A.on("rowupdated",this.onRowUpdated,this);A.on("rowremoved",this.onRemove,this)},onRefresh:function(){var F=this.grid.store,B;var D=this.getSelections();this.clearSelections(true);for(var C=0,A=D.length;C<A;C++){var E=D[C];if((B=F.indexOfId(E.id))!=-1){this.selectRow(B,true)}}if(D.length!=this.selections.getCount()){this.fireEvent("selectionchange",this)}},onRemove:function(A,B,C){if(this.selections.remove(C)!==false){this.fireEvent("selectionchange",this)}},onRowUpdated:function(A,B,C){if(this.isSelected(C)){A.onRowSelect(B)}},selectRecords:function(B,E){if(!E){this.clearSelections()}var D=this.grid.store;for(var C=0,A=B.length;C<A;C++){this.selectRow(D.indexOf(B[C]),true)}},getCount:function(){return this.selections.length},selectFirstRow:function(){this.selectRow(0)},selectLastRow:function(A){this.selectRow(this.grid.store.getCount()-1,A)},selectNext:function(A){if(this.hasNext()){this.selectRow(this.last+1,A);this.grid.getView().focusRow(this.last)}},selectPrevious:function(A){if(this.hasPrevious()){this.selectRow(this.last-1,A);this.grid.getView().focusRow(this.last)}},hasNext:function(){return this.last!==false&&(this.last+1)<this.grid.store.getCount()},hasPrevious:function(){return !!this.last},getSelections:function(){return[].concat(this.selections.items)},getSelected:function(){return this.selections.itemAt(0)},each:function(E,D){var C=this.getSelections();for(var B=0,A=C.length;B<A;B++){if(E.call(D||this,C[B],B)===false){return false}}return true},clearSelections:function(A){if(this.locked){return }if(A!==true){var C=this.grid.store;var B=this.selections;B.each(function(D){this.deselectRow(C.indexOfId(D.id))},this);B.clear()}else{this.selections.clear()}this.last=false},selectAll:function(){if(this.locked){return }this.selections.clear();for(var B=0,A=this.grid.store.getCount();B<A;B++){this.selectRow(B,true)}},hasSelection:function(){return this.selections.length>0},isSelected:function(A){var B=typeof A=="number"?this.grid.store.getAt(A):A;return(B&&this.selections.key(B.id)?true:false)},isIdSelected:function(A){return(this.selections.key(A)?true:false)},handleMouseDown:function(E,G,F){if(F.button!==0||this.isLocked()){return }var D=this.grid.store.getAt(G);if(this.fireEvent("rowclick",this,G,D)!==false){var A=this.grid.getView();if(F.shiftKey&&this.last!==false){var C=this.last;this.selectRange(C,G,F.ctrlKey);this.last=C;A.focusRow(G)}else{var B=this.isSelected(G);if(F.ctrlKey&&B){this.deselectRow(G)}else{if(!B||this.getCount()>1){this.selectRow(G,F.ctrlKey||F.shiftKey);A.focusRow(G)}}}}},selectRows:function(C,D){if(!D){this.clearSelections()}for(var B=0,A=C.length;B<A;B++){this.selectRow(C[B],true)}},selectRange:function(B,A,D){if(this.locked){return }if(!D){this.clearSelections()}if(B<=A){for(var C=B;C<=A;C++){this.selectRow(C,true)}}else{for(var C=B;C>=A;C--){this.selectRow(C,true)}}},deselectRange:function(C,B,A){if(this.locked){return }for(var D=C;D<=B;D++){this.deselectRow(D,A)}},selectRow:function(B,D,A){if(this.locked||(B<0||B>=this.grid.store.getCount())){return }var C=this.grid.store.getAt(B);if(this.fireEvent("beforerowselect",this,B,D,C)!==false){if(!D||this.singleSelect){this.clearSelections()}this.selections.add(C);this.last=this.lastActive=B;if(!A){this.grid.getView().onRowSelect(B)}this.fireEvent("rowselect",this,B,C);this.fireEvent("selectionchange",this)}},deselectRow:function(B,A){if(this.locked){return }if(this.last==B){this.last=false}if(this.lastActive==B){this.lastActive=false}var C=this.grid.store.getAt(B);this.selections.remove(C);if(!A){this.grid.getView().onRowDeselect(B)}this.fireEvent("rowdeselect",this,B,C);this.fireEvent("selectionchange",this)},restoreLast:function(){if(this._last){this.last=this._last}},acceptsNav:function(C,B,A){return !A.isHidden(B)&&A.isCellEditable(B,C)},onEditorKey:function(E,D){var B=D.getKey(),F,C=this.grid,A=C.activeEditor;if(B==D.TAB){D.stopEvent();A.completeEdit();if(D.shiftKey){F=C.walkCells(A.row,A.col-1,-1,this.acceptsNav,this)}else{F=C.walkCells(A.row,A.col+1,1,this.acceptsNav,this)}}else{if(B==D.ENTER){D.stopEvent();A.completeEdit();if(D.shiftKey){F=C.walkCells(A.row-1,A.col,-1,this.acceptsNav,this)}else{F=C.walkCells(A.row+1,A.col,1,this.acceptsNav,this)}}else{if(B==D.ESC){A.cancelEdit()}}}if(F){C.startEditing(F[0],F[1])}}});Ext.ux.grid.CheckboxSelectionModel=Ext.extend(Ext.ux.grid.RowSelectionModel,{header:'<div class="x-grid3-hd-checker">&#160;</div>',width:20,sortable:false,fixed:true,dataIndex:"",id:"checker",initEvents:function(){Ext.ux.grid.CheckboxSelectionModel.superclass.initEvents.call(this);this.grid.on("render",function(){var A=this.grid.getView();A.mainBody.on("mousedown",this.onMouseDown,this);Ext.fly(A.innerHd).on("mousedown",this.onHdMouseDown,this)},this)},onMouseDown:function(C,B){if(B.className=="x-grid3-row-checker"){C.stopEvent();var D=C.getTarget(".x-grid3-row");if(D){var A=D.rowIndex;if(this.isSelected(A)){this.deselectRow(A)}else{this.selectRow(A,true)}}}},onHdMouseDown:function(C,A){if(A.className=="x-grid3-hd-checker"){C.stopEvent();var B=Ext.fly(A.parentNode);var D=B.hasClass("x-grid3-hd-checker-on");if(D){B.removeClass("x-grid3-hd-checker-on");this.clearSelections()}else{B.addClass("x-grid3-hd-checker-on");this.selectAll()}}},renderer:function(B,C,A){return'<div class="x-grid3-row-checker">&#160;</div>'}});
Ext.namespace("Ext.ux.form");Ext.ux.form.Spinner=function(A){Ext.ux.form.Spinner.superclass.constructor.call(this,A);this.addEvents({spin:true,spinup:true,spindown:true})};Ext.extend(Ext.ux.form.Spinner,Ext.form.TriggerField,{triggerClass:"x-form-spinner-trigger",splitterClass:"x-form-spinner-splitter",alternateKey:Ext.EventObject.shiftKey,strategy:undefined,onRender:function(B,A){Ext.ux.form.Spinner.superclass.onRender.call(this,B,A);this.splitter=this.wrap.createChild({tag:"div",cls:this.splitterClass,style:"width:13px; height:2px;"});this.splitter.show().setRight((Ext.isIE)?1:2);this.splitter.show().setTop(10);this.proxy=this.trigger.createProxy("",this.splitter,true);this.proxy.addClass("x-form-spinner-proxy");this.proxy.setStyle("left","0px");this.proxy.setSize(14,1);this.proxy.hide();this.dd=new Ext.dd.DDProxy(this.splitter.dom.id,"SpinnerDrag",{dragElId:this.proxy.id});this.initSpinner()},initTrigger:function(){this.trigger.addClassOnOver("x-form-trigger-over");this.trigger.addClassOnClick("x-form-trigger-click")},initSpinner:function(){this.keyNav=new Ext.KeyNav(this.el,{up:function(A){A.preventDefault();this.onSpinUp()},down:function(A){A.preventDefault();this.onSpinDown()},pageUp:function(A){A.preventDefault();this.onSpinUpAlternate()},pageDown:function(A){A.preventDefault();this.onSpinDownAlternate()},scope:this});this.repeater=new Ext.util.ClickRepeater(this.trigger);this.repeater.on("click",this.onTriggerClick,this,{preventDefault:true});this.trigger.on("mouseover",this.onMouseOver,this,{preventDefault:true});this.trigger.on("mouseout",this.onMouseOut,this,{preventDefault:true});this.trigger.on("mousemove",this.onMouseMove,this,{preventDefault:true});this.trigger.on("mousedown",this.onMouseDown,this,{preventDefault:true});this.trigger.on("mouseup",this.onMouseUp,this,{preventDefault:true});this.wrap.on("mousewheel",this.handleMouseWheel,this);this.dd.setXConstraint(0,0,10);this.dd.setYConstraint(1500,1500,10);this.dd.endDrag=this.endDrag.createDelegate(this);this.dd.startDrag=this.startDrag.createDelegate(this);this.dd.onDrag=this.onDrag.createDelegate(this);if("object"==typeof this.strategy&&this.strategy.xtype){switch(this.strategy.xtype){case"number":this.strategy=new Ext.ux.form.Spinner.NumberStrategy(this.strategy);break;case"date":this.strategy=new Ext.ux.form.Spinner.DateStrategy(this.strategy);break;case"time":this.strategy=new Ext.ux.form.Spinner.TimeStrategy(this.strategy);break;default:delete (this.strategy);break}delete (this.strategy.xtype)}if(this.strategy==undefined){this.strategy=new Ext.ux.form.Spinner.NumberStrategy()}},onMouseOver:function(){if(this.disabled){return }var A=this.getMiddle();this.__tmphcls=(Ext.EventObject.getPageY()<A)?"x-form-spinner-overup":"x-form-spinner-overdown";this.trigger.addClass(this.__tmphcls)},onMouseOut:function(){this.trigger.removeClass(this.__tmphcls)},onMouseMove:function(){if(this.disabled){return }var A=this.getMiddle();if(((Ext.EventObject.getPageY()>A)&&this.__tmphcls=="x-form-spinner-overup")||((Ext.EventObject.getPageY()<A)&&this.__tmphcls=="x-form-spinner-overdown")){}},onMouseDown:function(){if(this.disabled){return }var A=this.getMiddle();this.__tmpccls=(Ext.EventObject.getPageY()<A)?"x-form-spinner-clickup":"x-form-spinner-clickdown";this.trigger.addClass(this.__tmpccls)},onMouseUp:function(){this.trigger.removeClass(this.__tmpccls)},onTriggerClick:function(){if(this.disabled||this.getEl().dom.readOnly){return }var B=this.getMiddle();var A=(Ext.EventObject.getPageY()<B)?"Up":"Down";this["onSpin"+A]()},getMiddle:function(){var B=this.trigger.getTop();var C=this.trigger.getHeight();var A=B+(C/2);return A},isSpinnable:function(){if(this.disabled||this.getEl().dom.readOnly){Ext.EventObject.preventDefault();return false}return true},handleMouseWheel:function(A){if(this.wrap.hasClass("x-trigger-wrap-focus")==false){return }var B=A.getWheelDelta();if(B>0){this.onSpinUp();A.stopEvent()}else{if(B<0){this.onSpinDown();A.stopEvent()}}},startDrag:function(){this.proxy.show();this._previousY=Ext.fly(this.dd.getDragEl()).getTop()},endDrag:function(){this.proxy.hide()},onDrag:function(){if(this.disabled){return }var B=Ext.fly(this.dd.getDragEl()).getTop();var A="";if(this._previousY>B){A="Up"}if(this._previousY<B){A="Down"}if(A!=""){this["onSpin"+A]()}this._previousY=B},onSpinUp:function(){if(this.isSpinnable()==false){return }if(Ext.EventObject.shiftKey==true){this.onSpinUpAlternate();return }else{this.strategy.onSpinUp(this)}this.fireEvent("spin",this);this.fireEvent("spinup",this)},onSpinDown:function(){if(this.isSpinnable()==false){return }if(Ext.EventObject.shiftKey==true){this.onSpinDownAlternate();return }else{this.strategy.onSpinDown(this)}this.fireEvent("spin",this);this.fireEvent("spindown",this)},onSpinUpAlternate:function(){if(this.isSpinnable()==false){return }this.strategy.onSpinUpAlternate(this);this.fireEvent("spin",this);this.fireEvent("spinup",this)},onSpinDownAlternate:function(){if(this.isSpinnable()==false){return }this.strategy.onSpinDownAlternate(this);this.fireEvent("spin",this);this.fireEvent("spindown",this)}});Ext.reg("spinner",Ext.ux.form.Spinner);Ext.ux.form.Spinner.Strategy=function(A){Ext.apply(this,A)};Ext.extend(Ext.ux.form.Spinner.Strategy,Ext.util.Observable,{defaultValue:0,minValue:undefined,maxValue:undefined,incrementValue:1,alternateIncrementValue:5,validationTask:new Ext.util.DelayedTask(),onSpinUp:function(A){this.spin(A,false,false)},onSpinDown:function(A){this.spin(A,true,false)},onSpinUpAlternate:function(A){this.spin(A,false,true)},onSpinDownAlternate:function(A){this.spin(A,true,true)},spin:function(A,C,B){this.validationTask.delay(500,function(){A.validate()})},fixBoundries:function(A){return A}});Ext.ux.form.Spinner.NumberStrategy=function(A){Ext.ux.form.Spinner.NumberStrategy.superclass.constructor.call(this,A)};Ext.extend(Ext.ux.form.Spinner.NumberStrategy,Ext.ux.form.Spinner.Strategy,{allowDecimals:true,decimalPrecision:2,spin:function(B,E,C){Ext.ux.form.Spinner.NumberStrategy.superclass.spin.call(this,B,E,C);var A=parseFloat(B.getValue());var D=(C==true)?this.alternateIncrementValue:this.incrementValue;(E==true)?A-=D:A+=D;A=(isNaN(A))?this.defaultValue:A;A=this.fixBoundries(A);B.setRawValue(A)},fixBoundries:function(B){var A=B;if(this.minValue!=undefined&&A<this.minValue){A=this.minValue}if(this.maxValue!=undefined&&A>this.maxValue){A=this.maxValue}return this.fixPrecision(A)},fixPrecision:function(B){var A=isNaN(B);if(!this.allowDecimals||this.decimalPrecision==-1||A||!B){return A?"":B}return parseFloat(parseFloat(B).toFixed(this.decimalPrecision))}});Ext.ux.form.Spinner.DateStrategy=function(A){Ext.ux.form.Spinner.DateStrategy.superclass.constructor.call(this,A)};Ext.extend(Ext.ux.form.Spinner.DateStrategy,Ext.ux.form.Spinner.Strategy,{defaultValue:new Date(),format:"Y-m-d",incrementValue:1,incrementConstant:Date.DAY,alternateIncrementValue:1,alternateIncrementConstant:Date.MONTH,spin:function(D,G,E){Ext.ux.form.Spinner.DateStrategy.superclass.spin.call(this);var A=D.getRawValue();A=Date.parseDate(A,this.format);var C=(G==true)?-1:1;var F=(E==true)?this.alternateIncrementValue:this.incrementValue;var B=(E==true)?this.alternateIncrementConstant:this.incrementConstant;if(typeof this.defaultValue=="string"){this.defaultValue=Date.parseDate(this.defaultValue,this.format)}A=(A)?A.add(B,C*F):this.defaultValue;A=this.fixBoundries(A);D.setRawValue(Ext.util.Format.date(A,this.format))},fixBoundries:function(B){var D=B;var C=(typeof this.minValue=="string")?Date.parseDate(this.minValue,this.format):this.minValue;var A=(typeof this.maxValue=="string")?Date.parseDate(this.maxValue,this.format):this.maxValue;if(this.minValue!=undefined&&D<C){D=C}if(this.maxValue!=undefined&&D>A){D=A}return D}});Ext.ux.form.Spinner.TimeStrategy=function(A){Ext.ux.form.Spinner.TimeStrategy.superclass.constructor.call(this,A)};Ext.extend(Ext.ux.form.Spinner.TimeStrategy,Ext.ux.form.Spinner.DateStrategy,{format:"H:i",incrementValue:1,incrementConstant:Date.MINUTE,alternateIncrementValue:1,alternateIncrementConstant:Date.HOUR});
Ext.ux.TabCloseMenu=function(){var A,C,B;this.init=function(E){A=E;A.on("contextmenu",D)};function D(G,F,I){if(!C){C=new Ext.menu.Menu([{id:A.id+"-close",text:"\u5173\u95ed\u6807\u7b7e",handler:function(){A.remove(B)}},{id:A.id+"-close-others",text:"\u5173\u95ed\u5176\u5b83\u6807\u7b7e",handler:function(){A.items.each(function(K){if(K.closable&&K!=B){A.remove(K)}})}},{id:A.id+"-close-all",text:"\u5173\u95ed\u5168\u90e8\u6807\u7b7e",handler:function(){A.items.each(function(K){if(K.closable){A.remove(K)}})}}])}B=F;var E=C.items;E.get(A.id+"-close").setDisabled(!F.closable);var J=true;var H=!F.closable;A.items.each(function(){if(this!=F&&this.closable){J=false;H=false;return false}});E.get(A.id+"-close-others").setDisabled(J);E.get(A.id+"-close-all").setDisabled(J);C.showAt(I.getPoint())}};
Ext.namespace("Ext.ux");Ext.namespace("Ext.ux.form");Ext.ux.form.TreeComboBox=Ext.extend(Ext.form.ComboBox,{tree:null,treeUrl:"\u672a\u8bbe\u7f6etreeUrl",treeRootId:4,treeRootText:"\u6839\u8282\u70b9",treeRootVisible:true,selectedClass:"",onSelect:Ext.emptyFn,maxHeight:200,border:false,mode:"local",forceSelection:false,blankText:"",emptyText:"",editable:false,triggerAction:"all",allowBlank:true,store:new Ext.data.SimpleStore({fields:[],data:[[]]}),init:function(){var B,C,D;var A=new Ext.tree.TreeLoader({dataUrl:this.treeUrl});this.tree=new Ext.tree.TreePanel({loader:A,border:false,rootVisible:this.treeRootVisible,renderTo:"tree-div-"+this.id,root:new Ext.tree.AsyncTreeNode({id:this.treeRootId,text:this.treeRootText,expanded:true}),listeners:{beforeload:function(E){A.dataUrl=this.treeUrl+E.id},click:function(E){this.setValue(E.text);this.hiddenField.value=E.id},dblclick:function(E){this.collapse()},scope:this}})},expand:function(){Ext.ux.form.TreeComboBox.superclass.expand.call(this);if(!this.tree){this.init()}},onRender:function(B,A){this.tpl='<tpl for="."><div style="height:'+this.maxHeight+'px"><div id="tree-div-'+this.id+'"></div></div></tpl>';Ext.ux.form.TreeComboBox.superclass.onRender.call(this,B,A)},onDestroy:function(){if(this.tree){this.tree.destroy();this.tree=null}Ext.ux.form.TreeComboBox.superclass.onDestroy.call(this)},setValue:function(A){if(this.hiddenField){this.hiddenField.value=A}Ext.ux.form.TreeComboBox.superclass.setValue.call(this,A);this.value=A},setHiddenValue:function(A){if(this.hiddenField){this.hiddenField.value=A}},getValue:function(){return Ext.ux.form.TreeComboBox.superclass.getValue.call(this)},getHiddenValue:function(){return this.hiddenField.value},reset:function(){Ext.ux.form.TreeComboBox.superclass.reset.call(this);if(this.hiddenField){this.hiddenField.value=this.hiddenValue==undefined?"":this.hiddenValue}}});Ext.reg("treecombo",Ext.ux.form.TreeComboBox);
Ext.namespace("Ext.ux");Ext.namespace("Ext.ux.form");Ext.ux.form.TreeField=Ext.extend(Ext.form.TriggerField,{treeWin:null,treeUrl:"\u672a\u8bbe\u7f6etreeUrl",treeRootId:4,treeRootText:"\u6839\u8282\u70b9",treeRootVisible:true,treeWinWidth:300,treeWinHeight:500,treeWinTitle:"\u9009\u62e9\u7a97\u53e3",invalidLevel:[-1],invalidTitle:"\u65e0\u6548\u9009\u62e9",invalidInfo:"\u60a8\u9009\u4e2d\u7684\u8282\u70b9\u4e3a\u65e0\u6548\u8282\u70b9\uff0c\u8bf7\u91cd\u65b0\u9009\u62e9\uff01",triggerClass:"x-form-search-trigger",init:function(){var B;var A=new Ext.tree.TreePanel({rootVisible:this.treeRootVisible,loader:new Ext.tree.TreeLoader({dataUrl:""}),autoScroll:true,root:new Ext.tree.AsyncTreeNode({text:this.treeRootText,id:this.treeRootId,leaf:"false",expanded:true,singleClickExpand:true}),listeners:{beforeload:function(C){A.loader.dataUrl=this.treeUrl+C.id},click:function(C){if(this.fireEvent("beforeselect",this,C)){B=C}else{B=null}},dblclick:function(C){if(B&&this.checkValidate(B.getDepth())){this.setValue(B.text);if(this.hiddenName){this.hiddenField.value=B.id}this.treeWin.hide();this.fireEvent("select",this,B)}else{Ext.MessageBox.show({title:this.invalidTitle,msg:this.invalidInfo,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}},scope:this}});this.treeWin=new Ext.Window({title:this.treeWinTitle,layout:"fit",width:this.treeWinWidth,height:this.treeWinHeight,items:A,modal:true,closeAction:"hide",resizable:false,buttonAlign:"center",buttons:[{text:"\u786e\u5b9a",listeners:{click:function(){if(B&&this.checkValidate(B.getDepth())==true){this.setValue(B.text);if(this.hiddenName){this.hiddenField.value=B.id}this.treeWin.hide();this.fireEvent("select",this,B)}else{Ext.MessageBox.show({title:this.invalidTitle,msg:this.invalidInfo,buttons:Ext.MessageBox.OK,icon:Ext.MessageBox.INFO})}},scope:this}},{text:"\u53d6\u6d88",listeners:{click:function(){this.treeWin.hide()},scope:this}}]})},checkValidate:function(B){var A=true;for(i=0;i<this.invalidLevel.length;i++){if(this.invalidLevel[i]==B){A=false}}return A},onTriggerClick:function(){if(this.disabled){return }if(!this.treeWin){this.init()}this.treeWin.show(this.trigger)},initComponent:function(){Ext.ux.form.TreeField.superclass.initComponent.call(this);this.addEvents("beforeselect","select")},afterRender:function(){Ext.ux.form.TreeField.superclass.afterRender.call(this);if(this.hiddenName){this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId||this.hiddenName)},"before",true);this.hiddenField.value=this.hiddenValue!==undefined?this.hiddenValue:this.value!==undefined?this.value:"";this.originalHiddenValue=this.hiddenField.value;this.el.dom.removeAttribute("name")}},onDestroy:function(){if(this.treeWin){this.treeWin.destroy();this.treeWin=null}Ext.ux.form.TreeField.superclass.onDestroy.call(this)},getValue:function(){if(this.hiddenField){return this.hiddenField.value}else{return Ext.form.ComboBox.superclass.getValue.call(this)}},getHiddenValue:function(){if(this.hiddenField){return this.hiddenField.value}else{return this.hiddenValue}},clearValue:function(){if(this.hiddenField){this.hiddenField.value="";this.hiddenValue=""}this.setRawValue("");this.value=""},setHiddenValue:function(A){if(this.hiddenField){this.hiddenValue=A;this.hiddenField.value=A}},reset:function(){Ext.ux.form.TreeField.superclass.reset.call(this);if(this.hiddenField){this.hiddenValue=this.originalHiddenValue;this.hiddenField.value=this.originalHiddenValue}}});Ext.reg("treefield",Ext.ux.form.TreeField);
Ext.namespace("Ext.ux");Ext.namespace("Ext.ux.form");Ext.ux.form.TreeMultiSelect=Ext.extend(Ext.form.TriggerField,{treeWin:null,treeUrl:"\u672a\u8bbe\u7f6etreeUrl",treeRootId:4,treeRootText:"\u6839\u8282\u70b9",treeRootVisible:true,treeWinWidth:500,treeWinHeight:400,treeWinTitle:"\u591a\u9009\u5bf9\u8bdd\u6846",triggerClass:"x-form-search-trigger",defaultSelected:[],nodeValueTypeSelect:0,init:function(){var G=Ext.data.Record.create([{name:"itemId",type:"string"},{name:"itemText",type:"string"}]);var J=new Ext.tree.TreePanel({title:"\u53ef\u9009\u9879",rootVisible:this.treeRootVisible,loader:new Ext.tree.TreeLoader({dataUrl:""}),autoScroll:true,enableDrag:true,ddGroup:"MultiSelect",region:"west",width:250,split:true,tools:[{id:"refresh",on:{click:function(){J.body.mask("\u6b63\u5728\u52a0\u8f7d\u6570\u636e...","x-mask-loading");J.root.reload();J.root.collapse(true,false);setTimeout(function(){J.body.unmask();J.root.expand(false,false)},1000)}}}],root:new Ext.tree.AsyncTreeNode({text:this.treeRootText,id:this.treeRootId,leaf:false,expanded:true,singleClickExpand:true}),listeners:{beforeload:function(K){J.loader.baseParams.category=K.attributes.category;J.loader.dataUrl=this.treeUrl+K.id},click:function(L){if(this.nodeValueTypeSelect==0){if(I.find("itemId",L.id)==-1){var K=new G({itemId:L.id,itemText:L.text});I.add(K)}}else{if(this.nodeValueTypeSelect==1){if(L.isLeaf()&&L.attributes.nodeValueType==1){if(I.find("itemId",L.id)==-1){var K=new G({itemId:L.id,itemText:L.text});I.add(K)}}}}},scope:this}});var F;var I=new Ext.data.SimpleStore({data:this.defaultSelected,fields:[{name:"itemId"},{name:"itemText"}],listeners:{add:function(){if(F){F.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")}},remove:function(){F.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")},load:function(){if(F){F.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")}},clear:function(){F.update("\u5171\u9009\u4e2d"+this.getCount()+"\u9879")}}});if(this.value!=null&&this.value!=""){var B=this.value.split(",");var H=this.hiddenField.value.split(",");for(var D=0;D<B.length;D++){I.add(new G({itemId:H[D],itemText:B[D]}))}}var E=new Ext.Action({text:"\u6e05\u7a7a\u5168\u90e8",handler:function(){I.removeAll()}});var C=this.nodeValueTypeSelect;var A=new Ext.grid.GridPanel({hideHeaders:true,store:I,enableHdMenu:false,enableDragDrop:true,ddGroup:"MultiSelect",tbar:[E],columns:[new Ext.grid.RowNumberer(),{header:"\u6807\u8bc6",width:60,sortable:false,dataIndex:"itemId",hidden:true},{id:"itemText",header:"\u540d\u79f0",width:160,sortable:false,dataIndex:"itemText"}],stripeRows:true,autoExpandColumn:"itemText",region:"center",sm:new Ext.grid.RowSelectionModel({listeners:{rowselect:function(M,L,K){if(L<I.getCount()-1){I.remove(K);A.getView().refresh()}else{I.remove.defer(10,I,[K])}}}}),listeners:{render:function(L){if(!F){var M=A.getTopToolbar();F=Ext.fly(M.el.dom).createChild({cls:"x-paging-info"});F.update("\u5171\u9009\u4e2d"+I.getCount()+"\u9879")}var K=new Ext.dd.DropTarget(A.getEl(),{ddGroup:"MultiSelect",copy:false,notifyDrop:function(O,T,R){var S=Ext.lib.Event.getTarget(T);var N="";var P=A.getView().findRowIndex(S);if(R.node!=null){if(C==0){if(I.find("itemId",R.node.id)==-1){var Q=new G({itemId:R.node.id,itemText:R.node.text});if(P===false){I.add(Q)}else{I.insert(P,Q)}A.getView().refresh();return true}}else{if(C==1){if(R.node.isLeaf()){if(I.find("itemId",R.node.id)==-1&&R.node.attributes.nodeValueType==1){var Q=new G({itemId:R.node.id,itemText:R.node.text});if(P===false){I.add(Q)}else{I.insert(P,Q)}A.getView().refresh();return true}}else{R.node.eachChild(function(V){if(V.isLeaf()&&I.find("itemId",V.id)==-1&&V.attributes.nodeValueType==1){var U=new G({itemId:V.id,itemText:V.text});if(P===false){I.add(U)}else{I.insert(P++,U)}}});A.getView().refresh();return true}}}}return false}})}}});this.treeWin=new Ext.Window({title:this.treeWinTitle,layout:"border",store:I,width:this.treeWinWidth,height:this.treeWinHeight,items:[J,A],modal:true,closeAction:"hide",resizable:false,buttonAlign:"center",buttons:[{text:"\u786e\u5b9a",listeners:{click:function(){var K=[],L=[];I.each(function(M){K.push(M.get("itemId"));L.push(M.get("itemText"))});this.setValue(L.join(","));if(this.hiddenName){this.hiddenField.value=K.join(",")}this.treeWin.hide()},scope:this}},{text:"\u53d6\u6d88",listeners:{click:function(){this.treeWin.hide()},scope:this}}]})},onTriggerClick:function(){if(this.disabled){return }if(!this.treeWin){this.init()}this.treeWin.show(this.trigger)},onRender:function(C,A){if(this.defaultSelected.length>0){var D="",F="",E="";for(var B=0;B<this.defaultSelected.length;B++){F=F+D+this.defaultSelected[B][0];E=E+D+this.defaultSelected[B][1];D=","}this.value=E;this.hiddenValue=F}Ext.ux.form.TreeMultiSelect.superclass.onRender.call(this,C,A);if(this.hiddenName){this.hiddenField=this.el.insertSibling({tag:"input",type:"hidden",name:this.hiddenName,id:(this.hiddenId||this.hiddenName)},"before",true);this.hiddenField.value=this.hiddenValue!==undefined?this.hiddenValue:this.value!==undefined?this.value:"";this.el.dom.removeAttribute("name")}},onDestroy:function(){if(this.treeWin){this.treeWin.destroy();this.treeWin=null}Ext.ux.form.TreeMultiSelect.superclass.onDestroy.call(this)},getValue:function(){if(this.hiddenField){return this.hiddenField.value}else{return Ext.form.ComboBox.superclass.getValue.call(this)}},getVisiableValue:function(){return Ext.form.ComboBox.superclass.getValue.call(this)},setSelectedValue:function(B){this.defaultSelected=B;if(this.defaultSelected.length>0){var C="",E="",D="";for(var A=0;A<this.defaultSelected.length;A++){E=E+C+this.defaultSelected[A][0];D=D+C+this.defaultSelected[A][1];C=","}this.setRawValue(D);this.hiddenValue=E;if(this.hiddenField){this.hiddenField.value=E}if(this.treeWin){if(this.defaultSelected.length>0){this.treeWin.store.loadData(this.defaultSelected)}else{this.treeWin.store.removeAll()}}}},clearValue:function(){if(this.hiddenField){this.hiddenField.value="";this.hiddenValue=""}this.setRawValue("");this.value=""},setHiddenValue:function(A){if(this.hiddenField){this.hiddenValue=A;this.hiddenField.value=A}},reset:function(){if(this.defaultSelected.length>0){var B="",D="",C="";for(var A=0;A<this.defaultSelected.length;A++){D=D+B+this.defaultSelected[A][0];C=C+B+this.defaultSelected[A][1];B=","}this.setRawValue(C);this.hiddenValue=D;if(this.hiddenField){this.hiddenField.value=D}if(this.treeWin){if(this.defaultSelected.length>0){this.treeWin.store.loadData(this.defaultSelected)}else{this.treeWin.store.removeAll()}}}}});Ext.reg("treemultiselect",Ext.ux.form.TreeMultiSelect);
function correctPNG(){var F=navigator.appVersion.split("MSIE");var G=parseFloat(F[1]);if((G>=5.5)&&(document.body.filters)){}for(var C=0;C<document.images.length;C++){var D=document.images[C];var I=D.src.toUpperCase();if(I.substring(I.length-3,I.length)=="PNG"){var E=(D.id)?"id='"+D.id+"' ":"";var J=(D.className)?"class='"+D.className+"' ":"";var B=(D.title)?"title='"+D.title+"' ":"title='"+D.alt+"' ";var H="display:inline-block;"+D.style.cssText;if(D.align=="left"){H="float:left;"+H}if(D.align=="right"){H="float:right;"+H}if(D.parentElement.href){H="cursor:hand;"+H}var A="<span "+E+J+B+' style="width:'+D.width+"px; height:"+D.height+"px;"+H+";filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(src='"+D.src+"', sizingMethod='scale');\"></span>";D.outerHTML=A;C=C-1}}}function uploadFile(D,F,A){var B;var C=new Ext.FormPanel({fileUpload:true,frame:true,bodyStyle:"padding: 10px 10px 0",border:false,labelWidth:60,labelAlign:"right",labelSeparator:"\uff1a",defaults:{anchor:"98%",allowBlank:false},items:[{xtype:"fileuploadfield",emptyText:"\u8bf7\u9009\u62e9\u4e00\u4e2a\u6587\u4ef6",fieldLabel:"\u6587\u4ef6\u540d",name:"fileName",buttonCfg:{text:"",iconCls:"upload-icon"},listeners:{fileselected:function(G,H){B=H}}},{xtype:"panel",hideLabel:true,bodyStyle:"padding: 10px 5px 0 20px",html:'<span style="color : blue">\u63d0\u793a\uff1a\u8bf7\u60a8\u9009\u62e9\u7684\u6587\u4ef6\u5927\u5c0f\u4e0d\u8981\u8d85\u8fc710M\uff01</span>'}]});var E=new Ext.Window({title:"\u6587\u4ef6\u4e0a\u4f20\u5bf9\u8bdd\u6846",height:160,width:500,layout:"fit",buttonAlign:"center",plain:true,items:[C],modal:true,buttons:[{text:"\u5f00\u59cb\u4e0a\u4f20",handler:function(){if(C.getForm().isValid()){C.getForm().submit({waitMsg:"\u6b63\u5728\u4e0a\u4f20\u6587\u4ef6\uff0c\u8bf7\u7a0d\u5019...",url:D,params:F,success:function(G,H){A(B,H.result);E.close();E=null}})}}},{text:"\u91cd\u7f6e",handler:function(){C.getForm().reset()}},{text:"\u53d6\u6d88",handler:function(){E.close();E=null}}]});E.show()}function deleteCache(A){}function copy2Clipboard(B){if(window.clipboardData){window.clipboardData.clearData();window.clipboardData.setData("Text",B)}else{if(navigator.userAgent.indexOf("Opera")!=-1){window.location=B}else{if(window.netscape){try{netscape.security.PrivilegeManager.enablePrivilege("UniversalXPConnect")}catch(F){alert("\u60a8\u7684firefox\u5b89\u5168\u9650\u5236\u9650\u5236\u60a8\u8fdb\u884c\u526a\u8d34\u677f\u64cd\u4f5c\uff0c\u8bf7\u6253\u5f00\u2019about:config\u2019\u5c06signed.applets.codebase_principal_support\u2019\u8bbe\u7f6e\u4e3atrue\u2019\u4e4b\u540e\u91cd\u8bd5\uff0c\u76f8\u5bf9\u8def\u5f84\u4e3afirefox\u6839\u76ee\u5f55/greprefs/all.js");return false}var D=Components.classes["@mozilla.org/widget/clipboard;1"].createInstance(Components.interfaces.nsIClipboard);if(!D){return }var C=Components.classes["@mozilla.org/widget/transferable;1"].createInstance(Components.interfaces.nsITransferable);if(!C){return }C.addDataFlavor("text/unicode");var G=new Object();var A=new Object();var G=Components.classes["@mozilla.org/supports-string;1"].createInstance(Components.interfaces.nsISupportsString);var H=B;G.data=H;C.setTransferData("text/unicode",G,H.length*2);var E=Components.interfaces.nsIClipboard;if(!D){return false}D.setData(C,null,E.kGlobalClipboard)}}}}function Array2JSON(E,O,K,C,D){var G={items:[],total:{}};var H;var N=(C==null?0:C);var Q=(D==null?E.length:D);var R;var F=[];var A=N;var B=0;var I;for(var L=1;L<O.length;L++){F.push(O[L])}for(var M=N;M-N<Q;M++){for(var L=0;L<K.length;L++){if(G.total[K[L]]){G.total[K[L]]=(G.total[K[L]]*100+parseFloat(E[M][K[L]])*100)/100}else{G.total[K[L]]=parseFloat(E[M][K[L]])}}if(O.length==1){if(I&&E[M][O[0]]==I[O[0]]){for(var L=0;L<K.length;L++){I[K[L]]=(I[K[L]]*100+parseFloat(E[M][K[L]])*100)/100}}else{var J={};J[O[0]]=E[M][O[0]];for(var L=0;L<K.length;L++){J[K[L]]=parseFloat(E[M][K[L]])}G.items.push(J);I=J}}else{if(!R){R=E[M][O[0]];B++}else{if(E[M][O[0]]==R){B++}else{var P=Array2JSON(E,F,K,A,B);P.title=R;G.items.push(P);A=M;B=1;R=E[M][O[0]]}}}}G.count=G.items.length;return G}function ArrayCount(A,J,G,D){var K=[];var L=[];var B=0;var H=J.length;var M=0;for(var F=0;F<A.length;F++){if(L.indexOf(A[F][G])<0){L[B++]=A[F][G]}}var O=[];var I=-1;var N=0;for(var F=0;F<A.length;F++){var C=[];for(var E=0;E<H;E++){C[E]=A[F][J[E]];if(C[E]!=O[E]){O=C;K.push(O)}}for(var E=0;E<=B;E++){if(!O[E+H]){O[E+H]=0}}I=L.indexOf(A[F][G])+H;N=parseFloat(A[F][D])*100;O[I]=(O[I]*100+N)/100;O[H+B]=(O[H+B]*100+N)/100;M=(M*100+N)/100}return{data:K,items:L,total:M}}function getDictMonth(A){var D=[];for(var B=1;B<=A;B++){var C=(new Date()).add(Date.MONTH,-B).format("Ym");D.push({DICT_ID:C,DICT_NAME:C})}return D}Ext.override(Ext.grid.GridPanel,{getExcelXml:function(B){var C=this.createWorksheet(B);var A=this.getColumnModel().getTotalWidth(B);return'<xml version="1.0" encoding="utf-8"><ss:Workbook xmlns:ss="urn:schemas-microsoft-com:office:spreadsheet" xmlns:x="urn:schemas-microsoft-com:office:excel" xmlns:o="urn:schemas-microsoft-com:office:office"><o:DocumentProperties><o:Title>data</o:Title></o:DocumentProperties><ss:ExcelWorkbook><ss:WindowHeight>'+C.height+"</ss:WindowHeight><ss:WindowWidth>"+C.width+'</ss:WindowWidth><ss:ProtectStructure>False</ss:ProtectStructure><ss:ProtectWindows>False</ss:ProtectWindows></ss:ExcelWorkbook><ss:Styles><ss:Style ss:ID="Default"><ss:Alignment ss:Vertical="Top" ss:WrapText="1" /><ss:Font ss:FontName="arial" ss:Size="10" /><ss:Borders><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Top" /><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Bottom" /><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Left" /><ss:Border ss:Color="#e4e4e4" ss:Weight="1" ss:LineStyle="Continuous" ss:Position="Right" /></ss:Borders><ss:Interior /><ss:NumberFormat /><ss:Protection /></ss:Style><ss:Style ss:ID="title"><ss:Borders /><ss:Font /><ss:Alignment ss:WrapText="1" ss:Vertical="Center" ss:Horizontal="Center" /><ss:NumberFormat ss:Format="@" /></ss:Style><ss:Style ss:ID="headercell"><ss:Font ss:Bold="1" ss:Size="10" /><ss:Alignment ss:WrapText="1" ss:Horizontal="Center" /><ss:Interior ss:Pattern="Solid" ss:Color="#A3C9FF" /></ss:Style><ss:Style ss:ID="even"><ss:Interior ss:Pattern="Solid" ss:Color="#FFFFFF" /></ss:Style><ss:Style ss:Parent="even" ss:ID="evendate"><ss:NumberFormat ss:Format="[ENG][$-409]dd-mmm-yyyy;@" /></ss:Style><ss:Style ss:Parent="even" ss:ID="evenint"><ss:NumberFormat ss:Format="0" /></ss:Style><ss:Style ss:Parent="even" ss:ID="evenfloat"><ss:NumberFormat ss:Format="0.00" /></ss:Style><ss:Style ss:ID="odd"><ss:Interior ss:Pattern="Solid" ss:Color="#CAFFC0" /></ss:Style><ss:Style ss:Parent="odd" ss:ID="odddate"><ss:NumberFormat ss:Format="[ENG][$-409]dd-mmm-yyyy;@" /></ss:Style><ss:Style ss:Parent="odd" ss:ID="oddint"><ss:NumberFormat ss:Format="0" /></ss:Style><ss:Style ss:Parent="odd" ss:ID="oddfloat"><ss:NumberFormat ss:Format="0.00" /></ss:Style></ss:Styles>'+C.xml+"</ss:Workbook></xml>"},createWorksheet:function(C){var N=[];var K=[];var F=this.getColumnModel();var E=0;var B="";var P="";for(var R=0;R<F.getColumnCount();R++){if((C||!F.isHidden(R))&&(F.getDataIndex(R)!="")){var H=F.getColumnWidth(R);E+=H;B+='<ss:Column ss:AutoFitWidth="1" ss:Width="'+H+'" />';P+='<ss:Cell ss:StyleID="headercell"><ss:Data ss:Type="String">'+F.getColumnHeader(R)+'</ss:Data><ss:NamedCell ss:Name="Print_Titles" /></ss:Cell>';var A=this.store.recordType.prototype.fields.get(F.getDataIndex(R));switch(A.type){case"int":N.push("Number");K.push("int");break;case"float":N.push("Number");K.push("float");break;case"bool":case"boolean":N.push("String");K.push("");break;case"date":N.push("DateTime");K.push("date");break;default:N.push("String");K.push("");break}}}var S=N.length;var G={height:9000,width:Math.floor(E*30)+50};var J='<ss:Worksheet ss:Name="data"><ss:Names><ss:NamedRange ss:Name="Print_Titles" ss:RefersTo="=\'data\'!R1:R2" /></ss:Names><ss:Table x:FullRows="1" x:FullColumns="1" ss:ExpandedColumnCount="'+S+'" ss:ExpandedRowCount="'+(this.store.getCount()+1)+'">'+B+'<ss:Row ss:AutoFitHeight="1">'+P+"</ss:Row>";for(var R=0,D=this.store.data.items,M=D.length;R<M;R++){J+="<ss:Row>";var L=(R&1)?"odd":"even";r=D[R].data;var O=0;for(var Q=0;Q<F.getColumnCount();Q++){if((C||!F.isHidden(Q))&&(F.getDataIndex(Q)!="")){var I=r[F.getDataIndex(Q)];J+='<ss:Cell ss:StyleID="'+L+K[O]+'"><ss:Data ss:Type="'+N[O]+'">';if(N[O]=="DateTime"){J+=I.format("Y-m-d")}else{J+=I}J+="</ss:Data></ss:Cell>";O++}}J+="</ss:Row>"}G.xml=J+'</ss:Table><x:WorksheetOptions><x:PageSetup><x:Layout x:CenterHorizontal="1" x:Orientation="Landscape" /><x:Footer x:Data="Page &amp;P of &amp;N" x:Margin="0.5" /><x:PageMargins x:Top="0.5" x:Right="0.5" x:Left="0.5" x:Bottom="0.8" /></x:PageSetup><x:FitToPage /><x:Print><x:PrintErrors>Blank</x:PrintErrors><x:FitWidth>1</x:FitWidth><x:FitHeight>32767</x:FitHeight><x:ValidPrinterInfo /><x:VerticalResolution>600</x:VerticalResolution></x:Print><x:Selected /><x:DoNotDisplayGridlines /><x:ProtectObjects>False</x:ProtectObjects><x:ProtectScenarios>False</x:ProtectScenarios></x:WorksheetOptions></ss:Worksheet>';return G}});Ext.apply(Ext.form.VTypes,{password:function(C,B){if(B.initialPassField){var A=Ext.getCmp(B.initialPassField);return(C==A.getValue())}return true},passwordText:"\u4e24\u6b21\u8f93\u5165\u7684\u5bc6\u7801\u4e0d\u4e00\u81f4\uff01",chinese:function(C,B){var A=/^[\u4e00-\u9fa5]+$/i;if(!A.test(C)){return false}return true},chineseText:"\u8bf7\u8f93\u5165\u4e2d\u6587",age:function(C,B){try{if(parseInt(C)>=18&&parseInt(C)<=100){return true}return false}catch(A){return false}},ageText:"\u5e74\u9f84\u8f93\u5165\u6709\u8bef",alphanum:function(C,B){try{if(!/\W/.test(C)){return true}return false}catch(A){return false}},alphanumText:"\u8bf7\u8f93\u5165\u82f1\u6587\u5b57\u6bcd\u6216\u662f\u6570\u5b57,\u5176\u5b83\u5b57\u7b26\u662f\u4e0d\u5141\u8bb8\u7684.",url:function(C,B){try{if(/^(http|https|ftp):\/\/(([A-Z0-9][A-Z0-9_-]*)(\.[A-Z0-9][A-Z0-9_-]*)+)(:(\d+))?\/?/i.test(C)){return true}return false}catch(A){return false}},urlText:"\u8bf7\u8f93\u5165\u6709\u6548\u7684URL\u5730\u5740.",max:function(C,B){try{if(parseFloat(C)<=parseFloat(B.max)){return true}return false}catch(A){return false}},maxText:"\u8d85\u8fc7\u6700\u5927\u503c",min:function(C,B){try{if(parseFloat(C)>=parseFloat(B.min)){return true}return false}catch(A){return false}},minText:"\u5c0f\u4e8e\u6700\u5c0f\u503c",datecn:function(E,C){try{var A=/^(\d{4})-(\d{2})-(\d{2})$/;if(!A.test(E)){return false}var D=new Date(E.replace(A,"$1/$2/$3"));return(parseInt(RegExp.$2,10)==(1+D.getMonth()))&&(parseInt(RegExp.$3,10)==D.getDate())&&(parseInt(RegExp.$1,10)==D.getFullYear())}catch(B){return false}},datecnText:"\u8bf7\u4f7f\u7528\u8fd9\u6837\u7684\u65e5\u671f\u683c\u5f0f: yyyy-mm-dd. \u4f8b\u5982:2008-06-20.",integer:function(C,B){try{if(/^[-+]?[\d]+$/.test(C)){return true}return false}catch(A){return false}},integerText:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u6574\u6570",minlength:function(C,B){try{if(C.length>=parseInt(B.minlen)){return true}return false}catch(A){return false}},minlengthText:"\u957f\u5ea6\u8fc7\u5c0f",maxlength:function(C,B){try{if(C.length<=parseInt(B.maxlen)){return true}return false}catch(A){return false}},maxlengthText:"\u957f\u5ea6\u8fc7\u5927",ip:function(C,B){try{if((/^(?:(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(C))){return true}return false}catch(A){return false}},ipText:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684IP\u5730\u5740",phone:function(C,B){try{if(/^((0[1-9]{3})?(0[12][0-9])?[-])?\d{6,8}$/.test(C)){return true}return false}catch(A){return false}},phoneText:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u7535\u8bdd\u53f7\u7801,\u5982:0431-29392929",mobilephone:function(C,B){try{if(/(^0?[1][35][0-9]{9}$)/.test(C)){return true}return false}catch(A){return false}},mobilephoneText:"\u8bf7\u8f93\u5165\u6b63\u786e\u7684\u624b\u673a\u53f7\u7801",alpha:function(C,B){try{if(/^[a-zA-Z]+$/.test(C)){return true}return false}catch(A){return false}},alphaText:"\u8bf7\u8f93\u5165\u82f1\u6587\u5b57\u6bcd"});function formatData(D){D=D+"";if(D.indexOf(".")>-1){if(D.substring(D.indexOf(".")+1).length>2){var A=1;var C=D;for(var B=1;B<=2;B++){A=A*10}C=C*A;C=Math.round(C);D=C/A}}return D};
Ext.UpdateManager.defaults.indicatorText='<div class="loading-indicator">\u52a0\u8f7d\u4e2d...</div>';if(Ext.View){Ext.View.prototype.emptyText=""}if(Ext.grid.GridPanel){Ext.grid.GridPanel.prototype.ddText="{0} \u9009\u62e9\u884c"}if(Ext.TabPanelItem){Ext.TabPanelItem.prototype.closeText="\u5173\u95ed"}if(Ext.form.Field){Ext.form.Field.prototype.invalidText="\u8f93\u5165\u503c\u975e\u6cd5"}Date.monthNames=["\u4e00\u6708","\u4e8c\u6708","\u4e09\u6708","\u56db\u6708","\u4e94\u6708","\u516d\u6708","\u4e03\u6708","\u516b\u6708","\u4e5d\u6708","\u5341\u6708","\u5341\u4e00\u6708","\u5341\u4e8c\u6708"];Date.dayNames=["\u65e5","\u4e00","\u4e8c","\u4e09","\u56db","\u4e94","\u516d"];if(Ext.MessageBox){Ext.MessageBox.buttonText={ok:"\u786e\u5b9a",cancel:"\u53d6\u6d88",yes:"\u662f",no:"\u5426"}}if(Ext.util.Format){Ext.util.Format.date=function(A,B){if(!A){return""}if(!(A instanceof Date)){A=new Date(Date.parse(A))}return A.dateFormat(B||"y\u5e74m\u6708d\u65e5")}}if(Ext.DatePicker){Ext.apply(Ext.DatePicker.prototype,{todayText:"\u4eca\u5929",minText:"\u65e5\u671f\u5728\u6700\u5c0f\u65e5\u671f\u4e4b\u524d",maxText:"\u65e5\u671f\u5728\u6700\u5927\u65e5\u671f\u4e4b\u540e",disabledDaysText:"",disabledDatesText:"",monthNames:Date.monthNames,dayNames:Date.dayNames,nextText:"\u4e0b\u6708 (Control+Right)",prevText:"\u4e0a\u6708 (Control+Left)",monthYearText:"\u9009\u62e9\u4e00\u4e2a\u6708 (Control+Up/Down \u6765\u6539\u53d8\u5e74)",todayTip:"{0} (\u7a7a\u683c\u952e\u9009\u62e9)",format:"y\u5e74m\u6708d\u65e5",okText:"\u786e\u5b9a",cancelText:"\u53d6\u6d88"})}if(Ext.PagingToolbar){Ext.apply(Ext.PagingToolbar.prototype,{beforePageText:"\u9875",afterPageText:"\u9875\u5171 {0} \u9875",firstText:"\u7b2c\u4e00\u9875",prevText:"\u524d\u4e00\u9875",nextText:"\u4e0b\u4e00\u9875",lastText:"\u6700\u540e\u9875",refreshText:"\u5237\u65b0",displayMsg:"\u663e\u793a {0} - {1}\uff0c\u5171 {2} \u6761",emptyMsg:"\u6ca1\u6709\u6570\u636e\u9700\u8981\u663e\u793a"})}if(Ext.form.TextField){Ext.apply(Ext.form.TextField.prototype,{minLengthText:"\u8be5\u8f93\u5165\u9879\u7684\u6700\u5c0f\u957f\u5ea6\u662f {0}",maxLengthText:"\u8be5\u8f93\u5165\u9879\u7684\u6700\u5927\u957f\u5ea6\u662f {0}",blankText:"\u8be5\u8f93\u5165\u9879\u4e3a\u5fc5\u8f93\u9879",regexText:"",emptyText:null})}if(Ext.form.NumberField){Ext.apply(Ext.form.NumberField.prototype,{minText:"\u8be5\u8f93\u5165\u9879\u7684\u6700\u5c0f\u503c\u662f {0}",maxText:"\u8be5\u8f93\u5165\u9879\u7684\u6700\u5927\u503c\u662f {0}",nanText:"{0} \u4e0d\u662f\u6709\u6548\u6570\u503c"})}if(Ext.form.DateField){Ext.apply(Ext.form.DateField.prototype,{disabledDaysText:"\u7981\u7528",disabledDatesText:"\u7981\u7528",minText:"\u8be5\u8f93\u5165\u9879\u7684\u65e5\u671f\u5fc5\u987b\u5728 {0} \u4e4b\u540e",maxText:"\u8be5\u8f93\u5165\u9879\u7684\u65e5\u671f\u5fc5\u987b\u5728 {0} \u4e4b\u524d",invalidText:"{0} \u662f\u65e0\u6548\u7684\u65e5\u671f - \u5fc5\u987b\u7b26\u5408\u683c\u5f0f\uff1a {1}",format:"y\u5e74m\u6708d\u65e5"})}if(Ext.form.ComboBox){Ext.apply(Ext.form.ComboBox.prototype,{loadingText:"\u52a0\u8f7d...",valueNotFoundText:undefined})}if(Ext.form.VTypes){Ext.apply(Ext.form.VTypes,{emailText:'\u8be5\u8f93\u5165\u9879\u5fc5\u987b\u662f\u7535\u5b50\u90ae\u4ef6\u5730\u5740\uff0c\u683c\u5f0f\u5982\uff1a "user@domain.com"',urlText:'\u8be5\u8f93\u5165\u9879\u5fc5\u987b\u662fURL\u5730\u5740\uff0c\u683c\u5f0f\u5982\uff1a "http://www.domain.com"',alphaText:"\u8be5\u8f93\u5165\u9879\u53ea\u80fd\u5305\u542b\u5b57\u7b26\u548c_",alphanumText:"\u8be5\u8f93\u5165\u9879\u53ea\u80fd\u5305\u542b\u5b57\u7b26,\u6570\u5b57\u548c_"})}if(Ext.grid.GridView){Ext.apply(Ext.grid.GridView.prototype,{sortAscText:"\u6b63\u5e8f",sortDescText:"\u9006\u5e8f",lockText:"\u9501\u5217",unlockText:"\u89e3\u9501\u5217",columnsText:"\u5217"})}if(Ext.grid.PropertyColumnModel){Ext.apply(Ext.grid.PropertyColumnModel.prototype,{nameText:"\u540d\u79f0",valueText:"\u503c",dateFormat:"y\u5e74m\u6708d\u65e5"})}if(Ext.layout.BorderLayout&&Ext.layout.BorderLayout.SplitRegion){Ext.apply(Ext.layout.BorderLayout.SplitRegion.prototype,{splitTip:"\u62d6\u52a8\u6765\u6539\u53d8\u5c3a\u5bf8.",collapsibleSplitTip:"\u62d6\u52a8\u6765\u6539\u53d8\u5c3a\u5bf8. \u53cc\u51fb\u9690\u85cf."})};
function getRootPath(){var C=window.document.location.href;var E=window.document.location.pathname;var D=C.indexOf(E);var A=C.substring(0,D);var B=E.substring(0,E.substr(1).indexOf("/")+1);return(A+B)}var oFCKeditorOptions={BasePath:"fckeditor/",Config:{BaseHref:window.location,SkinPath:getRootPath()+"/fckeditor/editor/skins/office2003/",ProcessHTMLEntities:true,ProcessNumericEntities:false},ToolbarSet:"Default"};Ext.form.FCKeditor=function(A){this.config=A;Ext.form.FCKeditor.superclass.constructor.call(this,A);this.FCKid=0;this.MyisLoaded=false;this.MyValue=""};Ext.extend(Ext.form.FCKeditor,Ext.form.TextArea,{onRender:function(B,A){if(!this.el){this.defaultAutoCreate={tag:"textarea",style:"width:100px;height:60px;",autocomplete:"off"}}Ext.form.TextArea.superclass.onRender.call(this,B,A);this.hideMode="visibility";this.hidden=true;if(this.grow){this.textSizeEl=Ext.DomHelper.append(document.body,{tag:"pre",cls:"x-form-grow-sizer"});if(this.preventScrollbars){this.el.setStyle("overflow","hidden")}this.el.setHeight(this.growMin)}if(this.FCKid==0){this.FCKid=get_FCKeditor_id_value()}setTimeout("loadFCKeditor('"+this.id+"',"+this.config.height+");",100)},setValue:function(A){this.MyValue=A;if(this.FCKid==0){this.FCKid=get_FCKeditor_id_value()}if(this.MyisLoaded){FCKeditorSetValue(this.FCKid,this.id,A)}else{}Ext.form.TextArea.superclass.setValue.apply(this,[A])},getValue:function(){if(this.MyisLoaded){value=FCKeditorGetValue(this.id);Ext.form.TextArea.superclass.setValue.apply(this,[value]);if(Ext.form.TextArea.superclass.getValue(this)){return Ext.form.TextArea.superclass.getValue(this)}else{return value}}else{return this.MyValue}},getRawValue:function(){if(this.MyisLoaded){value=FCKeditorGetValue(this.id);Ext.form.TextArea.superclass.setRawValue.apply(this,[value]);return Ext.form.TextArea.superclass.getRawValue(this)}else{return this.MyValue}}});Ext.reg("fckeditor",Ext.form.FCKeditor);function loadFCKeditor(B,A){oFCKeditor=new FCKeditor(B);oFCKeditor.BasePath=oFCKeditorOptions.BasePath;oFCKeditor.ToolbarSet=oFCKeditorOptions.ToolbarSet;oFCKeditor.Config=oFCKeditorOptions.Config;oFCKeditor.Height=A;oFCKeditor.ReplaceTextarea()}function FCKeditor_OnComplete(A){Ext.getCmp(A.Name).MyisLoaded=true}var FCKeditor_value=new Array();function FCKeditorSetValue(D,A,B){if((D!=undefined)&&(A!=undefined)){if(B!=undefined){FCKeditor_value[D]=B}else{if(FCKeditor_value[D]==undefined){FCKeditor_value[D]=""}}var C=FCKeditorAPI.GetInstance(A);if(C!=undefined){C.SetData(FCKeditor_value[D])}}}function FCKeditorGetValue(A){if((id!=undefined)&&(A!=undefined)){data="";var B=FCKeditorAPI.GetInstance(A);if(B!=undefined){data=B.GetData()}return data}}var FCKeditor_id_value;function get_FCKeditor_id_value(){if(!FCKeditor_id_value){FCKeditor_id_value=0}FCKeditor_id_value=FCKeditor_id_value+1;return FCKeditor_id_value};
(function(){var addListener=function(){if(window.addEventListener){return function(el,eventName,fn,capture){el.addEventListener(eventName,fn,!!capture)}}else{if(window.attachEvent){return function(el,eventName,fn,capture){el.attachEvent("on"+eventName,fn)}}else{return function(){}}}}(),removeListener=function(){if(window.removeEventListener){return function(el,eventName,fn,capture){el.removeEventListener(eventName,fn,(capture))}}else{if(window.detachEvent){return function(el,eventName,fn){el.detachEvent("on"+eventName,fn)}}else{return function(){}}}}();var EV=Ext.lib.Event;var MIM;var MASK_TARGET="x-frame-mask-target";Ext.ux.ManagedIFrame=function(){var args=Array.prototype.slice.call(arguments,0),el=Ext.get(args[0]),config=args[0];if(el&&el.dom&&el.dom.tagName=="IFRAME"){config=args[1]||{}}else{config=args[0]||args[1]||{};el=config.autoCreate?Ext.get(Ext.DomHelper.append(config.autoCreate.parent||Ext.getBody(),Ext.apply({tag:"iframe",frameborder:0,src:(Ext.isIE&&Ext.isSecure)?Ext.SSL_SECURE_URL:"about:blank"},config.autoCreate))):null;if(el&&this.unsupportedText){Ext.DomHelper.append(el.dom.parentNode,{tag:"noframes",html:this.unsupportedText})}}if(!el||el.dom.tagName!="IFRAME"){return el}el.dom.name||(el.dom.name=el.dom.id);el.dom.ownerEl=el;this.addEvents({focus:true,blur:true,unload:true,domready:true,documentloaded:true,exception:true,message:true});if(config.listeners){this.listeners=config.listeners;Ext.ux.ManagedIFrame.superclass.constructor.call(this)}Ext.apply(el,this);el.addClass("x-managed-iframe");if(config.style){el.applyStyles(config.style)}Ext.apply(el,{disableMessaging:config.disableMessaging===true,loadMask:!!config.loadMask?Ext.apply({msg:"Loading..",maskEl:null,hideOnReady:false,disabled:false},config.loadMask):false,_windowContext:null,eventsFollowFrameLinks:typeof config.eventsFollowFrameLinks=="undefined"?true:config.eventsFollowFrameLinks});if(el.loadMask){el.loadMask.maskEl||(el.loadMask.maskEl=el.parent("."+MASK_TARGET)||el.parent());el.loadMask.maskEl.addClass(MASK_TARGET)}var um=el.updateManager=new Ext.UpdateManager(el,true);um.showLoadIndicator=config.showLoadIndicator||false;Ext.ux.ManagedIFrame.Manager.register(el);if(config.src){el.setSrc(config.src)}else{var content=config.html||config.content||false;if(content){el.reset(null,function(frame){frame.update.apply(el,[].concat(content))})}}return el};Ext.extend(Ext.ux.ManagedIFrame,Ext.util.Observable,{src:null,CSS:null,manager:null,disableMessaging:true,domReadyRetries:7500,resetUrl:(function(){if(Ext.isIE&&Ext.isSecure){return Ext.SSL_SECURE_URL}else{return"about:blank"}})(),unsupportedText:"Inline frames are NOT enabled/supported by your browser.",setSrc:function(url,discardUrl,callback,scope){if(url&&typeof url=="object"){callback=url.callback||false;discardUrl=url.discardUrl||false;url=url.url||false;scope=url.scope||null}var src=url||this.src||this.resetUrl;this._windowContext=null;this._unHook();this._frameAction=this.frameInit=this._domReady=false;this.showMask();var s=this._targetURI=typeof src=="function"?src()||"":src;try{this._frameAction=true;this._callBack=typeof callback=="function"?callback.createDelegate(scope):null;this.dom.src=s;this.frameInit=true;this.checkDOM()}catch(ex){this.fireEvent("exception",this,ex)}if(discardUrl!==true){this.src=src}return this},setLocation:function(url,discardUrl,callback,scope){if(url&&typeof url=="object"){callback=url.callback||false;discardUrl=url.discardUrl||false;url=url.url||false;scope=url.scope||null}var src=url||this.src||this.resetUrl;this._windowContext=null;this._unHook();this._frameAction=this.frameInit=this._domReady=false;this.showMask();var s=this._targetURI=typeof src=="function"?src()||"":src;try{this._frameAction=true;this._callBack=typeof callback=="function"?callback.createDelegate(scope):null;this.getWindow().location.replace(s);this.frameInit=true;this.checkDOM()}catch(ex){this.fireEvent("exception",this,ex)}if(discardUrl!==true){this.src=src}return this},reset:function(src,callback,scope){this._unHook();var loadMaskOff=false;if(this.loadMask){loadMaskOff=this.loadMask.disabled;this.loadMask.disabled=false}this._callBack=function(frame){if(frame.loadMask){frame.loadMask.disabled=loadMaskOff}frame._frameAction=false;frame.frameInit=true;this._isReset=false;if(callback){callback.call(scope||window,frame)}};this.hideMask(true);this._frameAction=false;this.frameInit=true;this._isReset=true;var s=src;if(typeof src=="function"){s=src()}s=this._targetURI=Ext.isEmpty(s,true)?this.resetUrl:s;this.getWindow().location.href=s;return this},scriptRE:/(?:<script.*?>)((\n|\r|.)*?)(?:<\/script>)/gi,update:function(content,loadScripts,callback,scope){loadScripts=loadScripts||this.getUpdateManager().loadScripts||false;content=Ext.DomHelper.markup(content||"");content=loadScripts===true?content:content.replace(this.scriptRE,"");var doc;if((doc=this.getDocument())&&!!content.length){this._unHook();this._windowContext=this.src=null;this._targetURI=location.href;this.src=null;this.frameInit=true;this.showMask();this._callBack=typeof callback=="function"?callback.createDelegate(scope):null;doc.open();this._frameAction=true;doc.write(content);doc.close();this.checkDOM()}else{this.hideMask(true);if(callback){callback.call(scope,this)}}return this},disableMessaging:true,_XFrameMessaging:function(){var tagStack={"$":[]};var isEmpty=function(v,allowBlank){return v===null||v===undefined||(!allowBlank?v==="":false)};var apply=function(o,c,defaults){if(defaults){apply(o,defaults)}if(o&&c&&typeof c=="object"){for(var p in c){o[p]=c[p]}}return o};window.sendMessage=function(message,tag,origin){var MIF;if(MIF=arguments.callee.manager){if(message._fromHost){var fn,result;var compTag=message.tag||tag||null;var mstack=!isEmpty(compTag)?tagStack[compTag.toLowerCase()]||[]:tagStack["$"];for(var i=0,l=mstack.length;i<l;i++){if(fn=mstack[i]){result=fn.apply(fn.__scope,arguments)===false?false:result;if(fn.__single){mstack[i]=null}if(result===false){break}}}return result}else{message={type:isEmpty(tag)?"message":"message:"+tag.toLowerCase().replace(/^\s+|\s+$/g,""),data:message,domain:origin||document.domain,uri:document.documentURI,source:window,tag:isEmpty(tag)?null:tag.toLowerCase()};try{return MIF.disableMessaging!==true?MIF.fireEvent.call(MIF,message.type,MIF,message):null}catch(ex){}return null}}};window.onhostmessage=function(fn,scope,single,tag){if(typeof fn=="function"){if(!isEmpty(fn.__index)){throw"onhostmessage: duplicate handler definition"+(tag?" for tag:"+tag:"")}var k=isEmpty(tag)?"$":tag.toLowerCase();tagStack[k]||(tagStack[k]=[]);apply(fn,{__tag:k,__single:single||false,__scope:scope||window,__index:tagStack[k].length});tagStack[k].push(fn)}else{throw"onhostmessage: function required"}};window.unhostmessage=function(fn){if(typeof fn=="function"&&typeof fn.__index!="undefined"){var k=fn.__tag||"$";tagStack[k][fn.__index]=null}}},getHistory:function(){var h=null;try{h=this.getWindow().history}catch(eh){}return h},get:function(el){return MIM.El.get(this,el)},fly:function(el,named){named=named||"_global";el=this.getDom(el);if(!el){return null}if(!MIM._flyweights[named]){MIM._flyweights[named]=new Ext.Element.Flyweight()}MIM._flyweights[named].dom=el;return MIM._flyweights[named]},getDom:function(el){var d;if(!el||!(d=this.getDocument())){return null}return el.dom?el.dom:(typeof el=="string"?d.getElementById(el):el)},select:function(selector,unique){var d;return(d=this.getDocument())?Ext.Element.select(selector,unique,d):null},query:function(selector){var d;return(d=this.getDocument())?Ext.DomQuery.select(selector,d):null},getDoc:function(){return this.get(this.getDocument())},removeNode:function(node){MIM.removeNode(this,this.getDom(node))},_unHook:function(){var elcache,h=MIM.getFrameHash(this)||{};if(this._hooked){if(h&&(elcache=h.elCache)){for(var id in elcache){var el=elcache[id];if(el.removeAllListeners){el.removeAllListeners()}delete elcache[id]}if(h.docEl){h.docEl.removeAllListeners();h.docEl=null;delete h.docEl}}var w;if(this._frameProxy&&(w=this.getWindow())){removeListener(w,"focus",this._frameProxy);removeListener(w,"blur",this._frameProxy);removeListener(w,"resize",this._frameProxy);removeListener(w,"unload",this._frameProxy)}}this._hooked=this._domReady=this._domFired=this._frameAction=false;MIM._flyweights={};this.CSS=this.CSS?this.CSS.destroy():null},_renderHook:function(){this._windowContext=null;this.CSS=this.CSS?this.CSS.destroy():null;this._hooked=false;try{if(this.writeScript('(function(){(window.hostMIF = parent.Ext.get("'+this.dom.id+'"))._windowContext='+(Ext.isIE?"window":"{eval:function(s){return eval(s);}}")+";})();")){this._frameProxy||(this._frameProxy=MIM.eventProxy.createDelegate(this));var w;if(w=this.getWindow()){addListener(w,"focus",this._frameProxy);addListener(w,"blur",this._frameProxy);addListener(w,"resize",this._frameProxy);addListener(w,"unload",this._frameProxy)}if(this.disableMessaging!==true){this.loadFunction({name:"XMessage",fn:this._XFrameMessaging},false,true);var sm;if(sm=w.sendMessage){sm.manager=this}}this.CSS=new CSSInterface(this.getDocument())}}catch(ex){console.warn(ex)}return(this._hooked=this.domWritable())},sendMessage:function(message,tag,origin){var win;if(this.disableMessaging!==true&&(win=this.getWindow())){tag||(tag=message.tag||"");tag=tag.toLowerCase();message=Ext.applyIf(message.data?message:{data:message},{type:Ext.isEmpty(tag)?"message":"message:"+tag,domain:origin||document.domain,uri:document.documentURI,source:window,tag:tag||null,_fromHost:this});return win.sendMessage?win.sendMessage.call(null,message,tag,origin):null}return null},_windowContext:null,getDocument:function(){var win=this.getWindow(),doc=null;try{doc=(Ext.isIE&&win?win.document:null)||this.dom.contentDocument||window.frames[this.id].document||null}catch(gdEx){return false}return doc},getBody:function(){var d;return(d=this.getDocument())?d.body:null},getDocumentURI:function(){var URI,d;try{URI=this.src&&(d=this.getDocument())?d.location.href:null}catch(ex){}return URI||(typeof this.src=="function"?this.src():this.src)},getWindowURI:function(){var URI,w;try{URI=(w=this.getWindow())?w.location.href:null}catch(ex){}return URI||(typeof this.src=="function"?this.src():this.src)},getWindow:function(){var dom=this.dom,win=null;try{win=dom.contentWindow||window.frames[dom.name]||null}catch(gwEx){}return win},print:function(){var win;try{if(win=this.getWindow()){if(Ext.isIE){win.focus()}win.print()}}catch(ex){throw"print exception: "+(ex.description||ex.message||ex)}},destroy:function(){this.removeAllListeners();if(this.loadMask){this.hideMask(true);Ext.apply(this.loadMask,{masker:null,maskEl:null})}if(this.dom){Ext.ux.ManagedIFrame.Manager.deRegister(this);this.dom.ownerEl=this._windowContext=null;if(Ext.isIE&&this.dom.src){this.dom.src="javascript:false"}this._maskEl=null;this.remove()}},domWritable:function(){return !!this._windowContext},execScript:function(block,useDOM){try{if(this.domWritable()){if(useDOM){this.writeScript(block)}else{return this._windowContext.eval(block)}}else{throw"execScript:non-secure context"}}catch(ex){this.fireEvent("exception",this,ex);return false}return true},writeScript:function(block,attributes){attributes=Ext.apply({},attributes||{},{type:"text/javascript",text:block});try{var head,script,doc=this.getDocument();if(doc&&typeof doc.getElementsByTagName!="undefined"){if(!(head=doc.getElementsByTagName("head")[0])){head=doc.createElement("head");doc.getElementsByTagName("html")[0].appendChild(head)}if(head&&(script=doc.createElement("script"))){for(var attrib in attributes){if(attributes.hasOwnProperty(attrib)&&attrib in script){script[attrib]=attributes[attrib]}}return !!head.appendChild(script)}}}catch(ex){this.fireEvent("exception",this,ex)}return false},loadFunction:function(fn,useDOM,invokeIt){var name=fn.name||fn;var fn=fn.fn||window[fn];this.execScript(name+"="+fn,useDOM);if(invokeIt){this.execScript(name+"()")}},mask:function(msg,msgCls,maskCls){this._mask&&this.unmask();var p=this.parent("."+MASK_TARGET)||this.parent();if(p.getStyle("position")=="static"&&!p.select("iframe,frame,object,embed").elements.length){p.addClass("x-masked-relative")}p.addClass("x-masked");this._mask=Ext.DomHelper.append(p,{cls:maskCls||"ext-el-mask"},true);this._mask.setDisplayed(true);this._mask._agent=p;var delay=(this.loadMask?this.loadMask.delay:0)||10;if(typeof msg=="string"){this._maskMsg=Ext.DomHelper.append(p,{cls:msgCls||"ext-el-mask-msg x-mask-loading",style:{visibility:"hidden"},cn:{tag:"div",html:msg}},true);this._maskMsg.setVisibilityMode(Ext.Element.VISIBILITY);(function(){this._mask&&this._maskMsg&&this._maskMsg.center(p).setVisible(true)}).defer(delay,this)}if(Ext.isIE&&!(Ext.isIE7&&Ext.isStrict)&&this.getStyle("height")=="auto"){this._mask.setSize(undefined,this._mask.getHeight())}return this._mask},unmask:function(){var a;if(this._mask){(a=this._mask._agent)&&a.removeClass(["x-masked-relative","x-masked"]);if(this._maskMsg){this._maskMsg.remove();delete this._maskMsg}this._mask.remove();delete this._mask}},showMask:function(msg,msgCls,maskCls){var lmask=this.loadMask;if(lmask&&!lmask.disabled&&!this._mask){this.mask(msg||lmask.msg,msgCls||lmask.msgCls,maskCls||lmask.maskCls)}},hideMask:function(forced){var tlm=this.loadMask;if(tlm&&!!this._mask){if(forced||(tlm.hideOnReady&&this._domReady)){this.unmask()}}},submitAsTarget:function(submitCfg){var opt=submitCfg||{},D=document;var form=opt.form||Ext.DomHelper.append(D.body,{tag:"form",cls:"x-hidden"});form=Ext.getDom(form.form||form);form.target=this.dom.name;form.method=opt.method||"POST";opt.encoding&&(form.enctype=form.encoding=String(opt.encoding));opt.url&&(form.action=opt.url);var hiddens,hd;if(opt.params){hiddens=[];var ps=typeof opt.params=="string"?Ext.urlDecode(params,false):opt.params;for(var k in ps){if(ps.hasOwnProperty(k)){hd=D.createElement("input");hd.type="hidden";hd.name=k;hd.value=ps[k];form.appendChild(hd);hiddens.push(hd)}}}this._callBack=typeof opt.callback=="function"?opt.callback.createDelegate(opt.scope):null;this._frameAction=this.frameInit=true;this._targetURI=location.href;this.showMask();(function(){form.submit();hiddens&&Ext.each(hiddens,Ext.removeNode,Ext);Ext.fly(form,"_dynaForm").hasClass("x-hidden")&&Ext.removeNode(form);this.hideMask(true)}).defer(100,this)},loadHandler:function(e,target){target||(target={});var rstatus=(e&&typeof e.type!=="undefined"?e.type:this.dom.readyState);if(!this.frameInit||(!this._frameAction&&!this.eventsFollowFrameLinks)){return }switch(rstatus){case"domready":var M;try{M=this.getWindow()?this.getWindow().hostMIF:null}catch(access){}if(this._frameAction&&!M){this.frameInit&&this._renderHook()&&this.fireEvent.defer(1,this,["domready",this]);this._domFired=this._hooked}case"domfail":this._domReady=true;this.hideMask();break;case"load":case"complete":if(!this._domFired){this.loadHandler({type:"domready",id:this.id},this.dom)}Ext.isIE&&this.getWindow()&&this.getWindow().focus();if(this._frameAction||this.eventsFollowFrameLinks){this.fireEvent.defer(1,this,["documentloaded",this]);if(this._callBack){this._callBack.defer(1,null,[this])}}this._frameAction=this.frameInit=false;if(this.eventsFollowFrameLinks){this._domFired=this._domReady=false}this.hideMask(true);break;default:}this.frameState=rstatus},checkDOM:function(win){if(Ext.isOpera||Ext.isGecko||!this._frameAction){return }var n=0,manager=this,domReady=false,b,l,d,max=this.domReadyRetries,polling=false,startLocation=(this.getDocument()||{location:{}}).location.href;(function(){d=manager.getDocument()||{location:{}};polling=(d.location.href!==startLocation||d.location.href===manager._targetURI);if(!manager._frameAction||manager._domReady){return }domReady=polling&&((b=manager.getBody())&&!!(b.innerHTML||"").length)||false;if(d.location.href&&!domReady&&(++n<max)){setTimeout(arguments.callee,2);return }manager.loadHandler({type:domReady?"domready":"domfail"})})()}});var styleCamelRe=/(-[a-z])/gi;var styleCamelFn=function(m,a){return a.charAt(1).toUpperCase()};var CSSInterface=function(hostDocument){var doc;if(hostDocument){doc=hostDocument;return{rules:null,destroy:function(){return doc=null},createStyleSheet:function(cssText,id){var ss;if(!doc){return }var head=doc.getElementsByTagName("head")[0];var rules=doc.createElement("style");rules.setAttribute("type","text/css");if(id){rules.setAttribute("id",id)}if(Ext.isIE){head.appendChild(rules);ss=rules.styleSheet;ss.cssText=cssText}else{try{rules.appendChild(doc.createTextNode(cssText))}catch(e){rules.cssText=cssText}head.appendChild(rules);ss=rules.styleSheet?rules.styleSheet:(rules.sheet||doc.styleSheets[doc.styleSheets.length-1])}this.cacheStyleSheet(ss);return ss},removeStyleSheet:function(id){if(!doc){return }var existing=doc.getElementById(id);if(existing){existing.parentNode.removeChild(existing)}},swapStyleSheet:function(id,url){this.removeStyleSheet(id);if(!doc){return }var ss=doc.createElement("link");ss.setAttribute("rel","stylesheet");ss.setAttribute("type","text/css");ss.setAttribute("id",id);ss.setAttribute("href",url);doc.getElementsByTagName("head")[0].appendChild(ss)},refreshCache:function(){return this.getRules(true)},cacheStyleSheet:function(ss){if(this.rules){this.rules={}}try{var ssRules=ss.cssRules||ss.rules;for(var j=ssRules.length-1;j>=0;--j){this.rules[ssRules[j].selectorText]=ssRules[j]}}catch(e){}},getRules:function(refreshCache){if(this.rules==null||refreshCache){this.rules={};if(doc){var ds=doc.styleSheets;for(var i=0,len=ds.length;i<len;i++){try{this.cacheStyleSheet(ds[i])}catch(e){}}}}return this.rules},getRule:function(selector,refreshCache){var rs=this.getRules(refreshCache);if(!Ext.isArray(selector)){return rs[selector]}for(var i=0;i<selector.length;i++){if(rs[selector[i]]){return rs[selector[i]]}}return null},updateRule:function(selector,property,value){if(!Ext.isArray(selector)){var rule=this.getRule(selector);if(rule){rule.style[property.replace(styleCamelRe,styleCamelFn)]=value;return true}}else{for(var i=0;i<selector.length;i++){if(this.updateRule(selector[i],property,value)){return true}}}return false}}}};Ext.ux.ManagedIframePanel=Ext.extend(Ext.Panel,{defaultSrc:null,bodyStyle:{position:"relative"},frameStyle:{overflow:"auto"},frameConfig:null,hideMode:!Ext.isIE?"nosize":"display",shimCls:"x-frame-shim",shimUrl:null,loadMask:false,stateful:false,animCollapse:Ext.isIE&&Ext.enableFx,autoScroll:false,closable:true,ctype:"Ext.ux.ManagedIframePanel",showLoadIndicator:false,unsupportedText:"Inline frames are NOT enabled/supported by your browser.",initComponent:function(){var f=this.frameConfig?this.frameConfig.autoCreate||this.frameConfig:{};var frCfg=Ext.apply(f,{id:f.id||Ext.id()});frCfg.name=f.name||frCfg.id;if(Ext.isIE&&Ext.isSecure){frCfg.src=Ext.SSL_SECURE_URL}var frameTag=Ext.apply({tag:"iframe",frameborder:0,cls:"x-managed-iframe",style:this.frameStyle||f.style||{}},frCfg);var unsup=this.unsupportedText?{tag:"noframes",html:this.unsupportedText}:[];this.bodyCfg||(this.bodyCfg={cls:this.baseCls+"-body",children:this.contentEl?[]:[frameTag].concat(unsup)});this.autoScroll=false;this.items=null;if(this.stateful!==false){this.stateEvents||(this.stateEvents=["documentloaded"])}Ext.ux.ManagedIframePanel.superclass.initComponent.call(this);this.monitorResize||(this.monitorResize=!!this.fitToParent);this.addEvents({documentloaded:true,domready:true,message:true,exception:true,blur:true,focus:true});this.addListener=this.on},doLayout:function(){if(this.fitToParent&&!this.ownerCt){var pos=this.getPosition(),size=(Ext.get(this.fitToParent)||this.getEl().parent()).getViewSize();this.setSize(size.width-pos[0],size.height-pos[1])}Ext.ux.ManagedIframePanel.superclass.doLayout.apply(this,arguments)},beforeDestroy:function(){if(this.rendered){if(this.tools){for(var k in this.tools){Ext.destroy(this.tools[k])}}if(this.header&&this.headerAsText){var s;if(s=this.header.child("span")){s.remove(true,true)}this.header.update("")}Ext.each(["iframe","shim","header","topToolbar","bottomToolbar","footer","loadMask","body","bwrap"],function(elName){if(this[elName]){if(typeof this[elName].destroy=="function"){this[elName].destroy()}else{Ext.destroy(this[elName])}this[elName]=null;delete this[elName]}},this)}Ext.ux.ManagedIframePanel.superclass.beforeDestroy.call(this)},onDestroy:function(){Ext.Panel.superclass.onDestroy.call(this)},afterRender:function(container){var html=this.html;delete this.html;Ext.ux.ManagedIframePanel.superclass.afterRender.apply(this,arguments);if(this.iframe=this.body.child("iframe")){this.iframe.ownerCt=this;if(this.loadMask){var mEl;if(mEl=this.loadMask.maskEl){(this[mEl]||mEl||this.body).addClass(MASK_TARGET)}this.loadMask=Ext.apply({disabled:false,hideOnReady:false},this.loadMask)}this.getUpdater().showLoadIndicator=this.showLoadIndicator||false;var ownerCt=this.ownerCt;while(ownerCt){ownerCt.on("afterlayout",function(container,layout){var MIM=Ext.ux.ManagedIFrame.Manager,st=false;Ext.each(["north","south","east","west"],function(region){var reg;if((reg=layout[region])&&reg.splitEl){st=true;if(!reg.split._splitTrapped){reg.split.on("beforeresize",MIM.showShims,MIM);reg.split._splitTrapped=true}}},this);if(st&&!this._splitTrapped){this.on("resize",MIM.hideShims,MIM);this._splitTrapped=true}},this,{single:true});ownerCt=ownerCt.ownerCt}this.shim=Ext.get(this.body.child("."+this.shimCls))||Ext.DomHelper.append(this.body,{tag:"img",src:this.shimUrl||Ext.BLANK_IMAGE_URL,cls:this.shimCls,galleryimg:"no"},true);var El=Ext.Element;var mode=El[this.hideMode.toUpperCase()]||"x-hide-nosize";Ext.each([this[this.collapseEl],this.floating?null:this.getActionEl(),this.iframe],function(el){if(el){el.setVisibilityMode(mode)}},this);if(this.iframe=new Ext.ux.ManagedIFrame(this.iframe,{loadMask:this.loadMask,showLoadIndicator:this.showLoadIndicator,disableMessaging:this.disableMessaging,style:this.frameStyle,src:this.defaultSrc,html:html})){this.loadMask=this.iframe.loadMask;this.iframe.ownerCt=this;this.relayEvents(this.iframe,["blur","focus","unload","documentloaded","domready","exception","message"].concat(this._msgTagHandlers||[]));delete this._msgTagHandlers}}},sendMessage:function(){if(this.iframe){this.iframe.sendMessage.apply(this.iframe,arguments)}},filterOptRe:/^(?:scope|delay|buffer|single|stopEvent|preventDefault|stopPropagation|normalized|args|delegate)$/,on:function(name){var tagRE=/^message\:/i,n=null;if(typeof name=="object"){for(var na in name){if(!this.filterOptRe.test(na)&&tagRE.test(na)){n||(n=[]);n.push(na.toLowerCase())}}}else{if(tagRE.test(name)){n=[name.toLowerCase()]}}if(this.getFrame()&&n){this.relayEvents(this.iframe,n)}else{this._msgTagHandlers||(this._msgTagHandlers=[]);if(n){this._msgTagHandlers=this._msgTagHandlers.concat(n)}}Ext.ux.ManagedIframePanel.superclass.on.apply(this,arguments)},setSrc:function(url,discardUrl,callback,scope){url=url||this.defaultSrc||false;if(url&&this.rendered&&this.iframe){this.iframe.setSrc.call(this.iframe,url,discardUrl,callback,scope)}return this},setLocation:function(url,discardUrl,callback,scope){url=url||this.defaultSrc||false;if(url&&this.rendered&&this.iframe){this.iframe.setLocation.call(this.iframe,url,discardUrl,callback,scope)}return this},getState:function(){var URI=this.iframe?this.iframe.getDocumentURI()||null:null;return Ext.apply(Ext.ux.ManagedIframePanel.superclass.getState.call(this)||{},URI?{defaultSrc:typeof URI=="function"?URI():URI}:null)},getUpdater:function(){return this.rendered?(this.iframe||this.body).getUpdater():null},getFrame:function(){return this.rendered?this.iframe:null},getFrameWindow:function(){return this.rendered&&this.iframe?this.iframe.getWindow():null},getFrameDocument:function(){return this.rendered&&this.iframe?this.iframe.getDocument():null},getFrameDoc:function(){return this.rendered&&this.iframe?this.iframe.getDoc():null},getFrameBody:function(){return this.rendered&&this.iframe?this.iframe.getBody():null},load:function(loadCfg){var um;if(um=this.getUpdater()){if(loadCfg&&loadCfg.renderer){um.setRenderer(loadCfg.renderer);delete loadCfg.renderer}um.update.apply(um,arguments)}return this},doAutoLoad:function(){this.load(typeof this.autoLoad=="object"?this.autoLoad:{url:this.autoLoad})}});Ext.ux.ManagedIFrame.Manager=MIM=function(){var frames={};var implementation={readyHandler:function(e){try{var $frame=e.target.ownerEl;if($frame&&$frame._frameAction){$frame.loadHandler.call($frame,{type:"domready"})}}catch(rhEx){return }},shimCls:"x-frame-shim",register:function(frame){frame.manager=this;frames[frame.id]=frames[frame.dom.name]={ref:frame,elCache:{}};frame.dom[Ext.isIE?"onreadystatechange":"onload"]=frame.loadHandler.createDelegate(frame);return frame},deRegister:function(frame){frame._unHook();frame.dom.onload=frame.dom.onreadystatechange=null;delete frames[frame.id];delete frames[frame.dom.name]},hideShims:function(){if(!this.shimApplied){return }Ext.select("."+this.shimCls,true).removeClass(this.shimCls+"-on");this.shimApplied=false},showShims:function(){if(!this.shimApplied){this.shimApplied=true;Ext.select("."+this.shimCls,true).addClass(this.shimCls+"-on")}},getFrameById:function(id){return typeof id=="string"?(frames[id]?frames[id].ref||null:null):null},getFrameByName:function(name){return this.getFrameById(name)},getFrameHash:function(frame){return frame.id?frames[frame.id]:null},eventProxy:function(e){if(!e){return }e=Ext.EventObject.setEvent(e);var be=e.browserEvent||e;(e.type=="unload")&&this._unHook();if(!be.eventPhase||(be.eventPhase==(be.AT_TARGET||2))){return this.fireEvent(e.type,e)}},_flyweights:{},destroy:function(){if(document.addEventListener){window.removeEventListener("DOMFrameContentLoaded",this.readyHandler,true)}delete this._flyweights},removeNode:Ext.isIE?function(frame,n){frame=MIM.getFrameHash(frame);if(frame&&n&&n.tagName!="BODY"){d=frame.scratchDiv||(frame.scratchDiv=frame.getDocument().createElement("div"));d.appendChild(n);d.innerHTML=""}}:function(frame,n){if(n&&n.parentNode&&n.tagName!="BODY"){n.parentNode.removeChild(n)}}};if(document.addEventListener){window.addEventListener("DOMFrameContentLoaded",implementation.readyHandler,true)}Ext.EventManager.on(window,"beforeunload",implementation.destroy,implementation);return implementation}();MIM.showDragMask=MIM.showShims;MIM.hideDragMask=MIM.hideShims;MIM.El=function(frame,el,forceNew){var frameObj;frame=(frameObj=MIM.getFrameHash(frame))?frameObj.ref:null;if(!frame){return null}var elCache=frameObj.elCache||(frameObj.elCache={});var dom=frame.getDom(el);if(!dom){return null}var id=dom.id;if(forceNew!==true&&id&&elCache[id]){return elCache[id]}this.dom=dom;this.id=id||Ext.id(dom)};MIM.El.get=function(frame,el){var ex,elm,id,doc;if(!frame||!el){return null}var frameObj;frame=(frameObj=MIM.getFrameHash(frame))?frameObj.ref:null;if(!frame){return null}var elCache=frameObj.elCache||(frameObj.elCache={});if(!(doc=frame.getDocument())){return null}if(typeof el=="string"){if(!(elm=frame.getDom(el))){return null}if(ex=elCache[el]){ex.dom=elm}else{ex=elCache[el]=new MIM.El(frame,elm)}return ex}else{if(el.tagName){if(!(id=el.id)){id=Ext.id(el)}if(ex=elCache[id]){ex.dom=el}else{ex=elCache[id]=new MIM.El(frame,el)}return ex}else{if(el instanceof MIM.El){if(el!=frameObj.docEl){el.dom=frame.getDom(el.id)||el.dom;elCache[el.id]=el}return el}else{if(el.isComposite){return el}else{if(Ext.isArray(el)){return frame.select(el)}else{if(el==doc){if(!frameObj.docEl){var f=function(){};f.prototype=MIM.El.prototype;frameObj.docEl=new f();frameObj.docEl.dom=doc}return frameObj.docEl}}}}}}return null};Ext.apply(MIM.El.prototype,Ext.Element.prototype);Ext.ns("Ext.ux.panel","Ext.ux.portlet");Ext.reg("iframepanel",Ext.ux.panel.ManagedIframe=Ext.ux.ManagedIframePanel);Ext.ux.ManagedIframePortlet=Ext.extend(Ext.ux.ManagedIframePanel,{anchor:"100%",frame:true,collapseEl:"bwrap",collapsible:true,draggable:true,cls:"x-portlet"});Ext.reg("iframeportlet",Ext.ux.portlet.ManagedIframe=Ext.ux.ManagedIframePortlet);Ext.onReady(function(){var CSS=Ext.util.CSS,rules=[];CSS.getRule(".x-managed-iframe")||(rules.push(".x-managed-iframe {height:100%;width:100%;overflow:auto;position:relative;}"));CSS.getRule("."+MASK_TARGET)||(rules.push("."+MASK_TARGET+"{position:relative;zoom:1;}","."+MASK_TARGET+" .ext-el-mask-msg{z-index:101!important;} "));if(!CSS.getRule(".x-frame-shim")){rules.push(".x-frame-shim {z-index:8500;position:absolute;top:0px;left:0px;background:transparent!important;overflow:hidden;display:none;}");rules.push(".x-frame-shim-on{width:100%;height:100%;display:block;zoom:1;}");rules.push(".ext-ie6 .x-frame-shim{margin-left:5px;margin-top:3px;}")}CSS.getRule(".x-hide-nosize")||(rules.push(".x-hide-nosize,.x-hide-nosize *{height:0px!important;width:0px!important;border:none;}"));if(!!rules.length){CSS.createStyleSheet(rules.join(" "))}})})();if(Ext.provide){Ext.provide("miframe")};
Ext.ux.Portal=Ext.extend(Ext.Panel,{layout:"column",autoScroll:true,cls:"x-portal",defaultType:"portalcolumn",initComponent:function(){Ext.ux.Portal.superclass.initComponent.call(this);this.addEvents({validatedrop:true,beforedragover:true,dragover:true,beforedrop:true,drop:true})},initEvents:function(){Ext.ux.Portal.superclass.initEvents.call(this);this.dd=new Ext.ux.Portal.DropZone(this,this.dropConfig)}});Ext.reg("portal",Ext.ux.Portal);Ext.ux.Portal.DropZone=function(A,B){this.portal=A;Ext.dd.ScrollManager.register(A.body);Ext.ux.Portal.DropZone.superclass.constructor.call(this,A.bwrap.dom,B);A.body.ddScrollConfig=this.ddScrollConfig};Ext.extend(Ext.ux.Portal.DropZone,Ext.dd.DropTarget,{ddScrollConfig:{vthresh:50,hthresh:-1,animate:true,increment:200},createEvent:function(A,D,C,B,F,E){return{portal:this.portal,panel:C.panel,columnIndex:B,column:F,position:E,data:C,source:A,rawEvent:D,status:this.dropAllowed}},notifyOver:function(Q,O,R){var D=O.getXY(),A=this.portal,J=Q.proxy;if(!this.grid){this.grid=this.getGrid()}var B=A.body.dom.clientWidth;if(!this.lastCW){this.lastCW=B}else{if(this.lastCW!=B){this.lastCW=B;A.doLayout();this.grid=this.getGrid()}}var C=0,H=this.grid.columnX,I=false;for(var M=H.length;C<M;C++){if(D[0]<(H[C].x+H[C].w)){I=true;break}}if(!I){C--}var L,G=false,F=0,P=A.items.itemAt(C),K=P.items.items;for(var M=K.length;F<M;F++){L=K[F];var N=L.el.getHeight();if(N!==0&&(L.el.getY()+(N/2))>D[1]){G=true;break}}var E=this.createEvent(Q,O,R,C,P,G&&L?F:P.items.getCount());if(A.fireEvent("validatedrop",E)!==false&&A.fireEvent("beforedragover",E)!==false){J.getProxy().setWidth("auto");if(L){J.moveProxy(L.el.dom.parentNode,G?L.el.dom:null)}else{J.moveProxy(P.el.dom,null)}this.lastPos={c:P,col:C,p:G&&L?F:false};this.scrollPos=A.body.getScroll();A.fireEvent("dragover",E);return E.status}else{return E.status}},notifyOut:function(){delete this.grid},notifyDrop:function(H,D,C){delete this.grid;if(!this.lastPos){return }var F=this.lastPos.c,B=this.lastPos.col,G=this.lastPos.p;var A=this.createEvent(H,D,C,B,F,G!==false?G:F.items.getCount());if(this.portal.fireEvent("validatedrop",A)!==false&&this.portal.fireEvent("beforedrop",A)!==false){H.proxy.getProxy().remove();H.panel.el.dom.parentNode.removeChild(H.panel.el.dom);if(G!==false){F.insert(G,H.panel)}else{F.add(H.panel)}F.doLayout();this.portal.fireEvent("drop",A);var I=this.scrollPos.top;if(I){var E=this.portal.body.dom;setTimeout(function(){E.scrollTop=I},10)}}delete this.lastPos},getGrid:function(){var A=this.portal.bwrap.getBox();A.columnX=[];this.portal.items.each(function(B){A.columnX.push({x:B.el.getX(),w:B.el.getWidth()})});return A}});Ext.ux.PortalColumn=Ext.extend(Ext.Container,{layout:"anchor",autoEl:"div",defaultType:"portlet",cls:"x-portal-column"});Ext.reg("portalcolumn",Ext.ux.PortalColumn);Ext.ux.Portlet=Ext.extend(Ext.Panel,{anchor:"100%",frame:true,collapsible:true,draggable:true,cls:"x-portlet",heightIncrement:5,pinned:false,duration:0.6,easing:"backIn",transparent:false,onRender:function(B,A){Ext.ux.Portlet.superclass.onRender.call(this,B,A);var C=Ext.Element.prototype.createProxy;Ext.Element.prototype.createProxy=function(D){return Ext.DomHelper.append(this.dom,D,true)};this.resizer=new Ext.Resizable(this.el,{animate:true,duration:this.duration,easing:this.easing,handles:"s",transparent:this.transparent,heightIncrement:this.heightIncrement,minHeight:this.minHeight||100,pinned:this.pinned});this.resizer.on("resize",this.onResizer,this);Ext.Element.prototype.createProxy=C},onResizer:function(B,A,D,C){this.setHeight(D)},onCollapse:function(A,B){this.el.setHeight("");Ext.ux.Portlet.superclass.onCollapse.call(this,A,B)}});Ext.reg("portlet",Ext.ux.Portlet);Ext.ux.TemplatePortlet=Ext.extend(Ext.ux.Portlet,{rowCount:10,autoScroll:true,refreshFn:function(){this.getUpdater().update({url:this.updateUrl,params:Ext.util.JSON.decode.call(this,this.updateParams),text:'<span style="font-size: 9pt; font-family: \u5b8b\u4f53;color:blue">\u8bf7\u7a0d\u5019\uff0c\u6570\u636e\u52a0\u8f7d\u4e2d...</span>'})},bodyStyle:"padding:0px 4px 4px 4px;",initComponent:function(){Ext.ux.TemplatePortlet.superclass.initComponent.call(this)},onRender:function(B,A){Ext.ux.TemplatePortlet.superclass.onRender.call(this,B,A);var C=this.getUpdater();C.tpl=(new Ext.XTemplate(this.tmpltStr,this.tmpltFn)).compile();C.emptyHtml=this.emptyHtml;C.setRenderer({render:function(F,D,E,H){var G=Ext.util.JSON.decode(D.responseText);if(G.data.length>0){E.tpl.overwrite(F,G)}else{if(E.emptyHtml){F.dom.innerHTML=E.emptyHtml}}}});C.update({url:this.updateUrl,params:Ext.util.JSON.decode.call(this,this.updateParams),text:'<span style="font-size: 9pt; font-family: \u5b8b\u4f53;color:blue">\u8bf7\u7a0d\u5019\uff0c\u6570\u636e\u52a0\u8f7d\u4e2d...</span>'});if(this.refreshTimeout&&(this.refreshTimeout>0)){C.startAutoRefresh(this.refreshTimeout,this.updateUrl,this.updateParams)}},onDestroy:function(){Ext.ux.TemplatePortlet.superclass.onDestroy.call(this)}});Ext.reg("templateportlet",Ext.ux.TemplatePortlet);Ext.ux.GridPortlet=Ext.extend(Ext.ux.Portlet,{layout:"fit",updateUrl:"execQuery.do",refreshFn:function(){Ext.Ajax.request({url:this.updateUrl,params:this.updateParams,success:function(A,B){var C=Ext.util.JSON.decode(A.responseText);this.store.loadData(C.data);this.doLayout()},scope:this})},initComponent:function(){Ext.ux.GridPortlet.superclass.initComponent.call(this)},onRender:function(ct,position){Ext.ux.GridPortlet.superclass.onRender.call(this,ct,position);Ext.Ajax.request({url:this.updateUrl,params:this.updateParams,success:function(result,request){var obj=Ext.util.JSON.decode(result.responseText);var resultColumns=[];var storeFields=[];var colConf=obj.queryConfig.RESULT_ITEM;for(var i=0;i<colConf.length;i++){var col={};col.name=colConf[i].QUERY_RESULT_ID;col.type=colConf[i].RESULT_TYPE;storeFields.push(col);var cm={};cm.id=colConf[i].QUERY_RESULT_ID;cm.header=colConf[i].QUERY_RESULT_NAME;cm.sortable=false;cm.hidden=(colConf[i].IS_VISIBLE==0);cm.dataIndex=colConf[i].QUERY_RESULT_ID;if(colConf[i].RENDERER){cm.renderer=eval(colConf[i].RENDERER)}if(colConf[i].WIDTH!="0"){cm.width=parseInt(colConf[i].WIDTH)}resultColumns.push(cm)}this.store=new Ext.data.SimpleStore({data:obj.data,fields:storeFields});this.grid=new Ext.grid.GridPanel({border:false,store:this.store,enableHdMenu:false,stripeRows:true,columns:resultColumns});this.add(this.grid);this.doLayout()},failure:function(request){},scope:this})},onDestroy:function(){if(this.grid){this.grid.removeAllListeners();this.grid.remove();this.grid=null}this.store.removeAllListeners();Ext.ux.GridPortlet.superclass.onDestroy.call(this)}});Ext.reg("gridportlet",Ext.ux.GridPortlet);
